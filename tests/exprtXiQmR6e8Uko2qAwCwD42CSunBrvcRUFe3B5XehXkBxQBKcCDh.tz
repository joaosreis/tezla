{ parameter (or (unit %pop) (nat %push)) ;
  storage (pair (pair (int %first) (int %last)) (map %saved int nat)) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { PAIR ;
             DUP ;
             { CDR ; CAR ; CDR } ;
             DUP 2 ;
             { CDR ; CAR ; CAR } ;
             COMPARE ;
             LT ;
             IF {}
                { PUSH string "WrongCondition: self.data.first < self.data.last" ; FAILWITH } ;
             DUP ;
             CDR ;
             DUP ;
             CDR ;
             DUP 2 ;
             { CAR ; CAR } ;
             NONE nat ;
             SWAP ;
             UPDATE ;
             SWAP ;
             CAR ;
             PAIR ;
             SWAP ;
             CAR ;
             PAIR ;
             DUP ;
             CDR ;
             DUP ;
             { CAR ; CAR } ;
             PUSH int 1 ;
             ADD ;
             SWAP ;
             { DUP ;
               DIP { CAR @%% ; { CDR @%% ; SWAP ; PAIR % %@ } } ;
               CDR @%% ;
               SWAP ;
               PAIR %@ %@ } ;
             SWAP ;
             DROP ;
             NIL operation ;
             PAIR }
           { PAIR ;
             DUP ;
             CDR ;
             DUP ;
             { CAR ; CDR } ;
             PUSH int 1 ;
             ADD ;
             SWAP ;
             { DUP ;
               DIP { CAR @%% ; { CAR @%% ; PAIR %@ % } } ;
               CDR @%% ;
               SWAP ;
               PAIR %@ %@ } ;
             SWAP ;
             CAR ;
             PAIR ;
             DUP ;
             CDR ;
             DUP ;
             CDR ;
             DUP 2 ;
             { CAR ; CDR } ;
             DUP 4 ;
             CAR ;
             SOME ;
             SWAP ;
             UPDATE ;
             SWAP ;
             CAR ;
             PAIR ;
             SWAP ;
             DROP ;
             NIL operation ;
             PAIR } } }
