{ parameter
    (or (address %setMain)
        (pair %use
           mutez
           (pair (pair (pair (pair (big_map %address_map nat address) (big_map %allowed address bool))
                             (pair (big_map %circles nat mutez) (big_map %key_hash_map nat key_hash)))
                       (pair (pair (big_map %nat_map nat nat) (timestamp %next_circle))
                             (pair (mutez %reward) (big_map %shares address nat))))
                 (pair (pair (big_map %vetoVoters address nat) (big_map %vetos key_hash timestamp))
                       (pair (big_map %voters
                                address
                                (pair (map %allowances address bool) (option %candidate key_hash)))
                             (big_map %votes key_hash nat)))))) ;
  storage address ;
  code { DUP ;
         CDR ;
         DIG 1 ;
         DUP ;
         DUG 2 ;
         CAR ;
         IF_LEFT
           { PUSH address "tz1burnburnburnburnburnburnburjAYjjX" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             COMPARE ;
             EQ ;
             IF { DUP } { PUSH string "01" ; FAILWITH } ;
             NIL operation ;
             PAIR ;
             DIP { DROP } }
           { DIG 1 ;
             DUP ;
             DUG 2 ;
             DIG 1 ;
             DUP ;
             DUG 2 ;
             CDR ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             CAR ;
             PAIR ;
             PAIR ;
             DUP ;
             CAR ;
             CDR ;
             DIG 1 ;
             DUP ;
             DUG 2 ;
             CDR ;
             SENDER ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             COMPARE ;
             EQ ;
             IF { PUSH unit Unit } { PUSH string "03" ; FAILWITH } ;
             DIG 1 ;
             DUP ;
             DUG 2 ;
             DIG 4 ;
             DUP ;
             DUG 5 ;
             CAR ;
             CAR ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             CAR ;
             CDR ;
             CDR ;
             CAR ;
             ADD ;
             DIP { DUP ;
                   CDR ;
                   SWAP ;
                   CAR ;
                   DUP ;
                   CAR ;
                   SWAP ;
                   CDR ;
                   DUP ;
                   CAR ;
                   SWAP ;
                   CDR ;
                   CDR } ;
             PAIR ;
             SWAP ;
             PAIR ;
             SWAP ;
             PAIR ;
             PAIR ;
             NIL operation ;
             DIG 1 ;
             DUP ;
             DUG 2 ;
             DIG 1 ;
             DUP ;
             DUG 2 ;
             PAIR ;
             NOW ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             CAR ;
             CDR ;
             CAR ;
             CDR ;
             COMPARE ;
             LT ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DIG 3 ;
                  DUP ;
                  DUG 4 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DIG 4 ;
                  DUP ;
                  DUG 5 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CAR ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CAR ;
                  PUSH nat 7 ;
                  GET ;
                  IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                  SWAP ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  DIP { DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        DUP ;
                        CAR ;
                        SWAP ;
                        CDR ;
                        CDR } ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  PUSH mutez 0 ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DIG 1 ;
                  DUP ;
                  DUG 2 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CAR ;
                  PUSH nat 1 ;
                  DIG 3 ;
                  DUP ;
                  DUG 4 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  CAR ;
                  PUSH nat 7 ;
                  GET ;
                  IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                  ADD ;
                  SOME ;
                  PUSH nat 7 ;
                  UPDATE ;
                  DIP { DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        DUP ;
                        CAR ;
                        SWAP ;
                        CDR ;
                        DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        CDR } ;
                  PAIR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  PUSH int 1474560 ;
                  NOW ;
                  ADD ;
                  DIP { DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        DUP ;
                        CAR ;
                        SWAP ;
                        CDR ;
                        DUP ;
                        CDR ;
                        SWAP ;
                        CAR ;
                        CAR } ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DIG 6 ;
                  DUP ;
                  DUG 7 ;
                  PAIR ;
                  DIG 1 ;
                  DUP ;
                  DUG 2 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CDR ;
                  PUSH nat 1 ;
                  GET ;
                  IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                  DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  CAR ;
                  CAR ;
                  CDR ;
                  CDR ;
                  PUSH nat 0 ;
                  GET ;
                  IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                  COMPARE ;
                  EQ ;
                  IF { DUP }
                     { DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       DIG 11 ;
                       DUP ;
                       DUG 12 ;
                       CONTRACT %requestOperation (option key_hash) ;
                       IF_NONE { PUSH string "01" ; FAILWITH } { DUP ; DIP { DROP } } ;
                       PUSH mutez 0 ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       CAR ;
                       CAR ;
                       CDR ;
                       CDR ;
                       PUSH nat 1 ;
                       GET ;
                       IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                       SOME ;
                       TRANSFER_TOKENS ;
                       CONS ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       CAR ;
                       CAR ;
                       CDR ;
                       CDR ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       CAR ;
                       CAR ;
                       CDR ;
                       CDR ;
                       PUSH nat 1 ;
                       GET ;
                       IF_NONE { PUSH string "MAP FIND" ; FAILWITH } {} ;
                       SOME ;
                       PUSH nat 0 ;
                       UPDATE ;
                       DIP { DUP ;
                             CDR ;
                             SWAP ;
                             CAR ;
                             DUP ;
                             CDR ;
                             SWAP ;
                             CAR ;
                             DUP ;
                             CAR ;
                             SWAP ;
                             CDR ;
                             CAR } ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       PAIR ;
                       PAIR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       SWAP ;
                       CDR ;
                       SWAP ;
                       PAIR ;
                       DIG 1 ;
                       DUP ;
                       DUG 2 ;
                       SWAP ;
                       CAR ;
                       PAIR ;
                       DIP { DROP 2 } } ;
                  DIG 6 ;
                  DUP ;
                  DUG 7 ;
                  DIG 6 ;
                  DUP ;
                  DUG 7 ;
                  SWAP ;
                  CAR ;
                  PAIR ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  SWAP ;
                  CAR ;
                  PAIR ;
                  DIG 4 ;
                  DUP ;
                  DUG 5 ;
                  SWAP ;
                  CAR ;
                  PAIR ;
                  DIG 3 ;
                  DUP ;
                  DUG 4 ;
                  SWAP ;
                  CAR ;
                  PAIR ;
                  DIG 1 ;
                  DUP ;
                  DUG 2 ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  SWAP ;
                  PAIR ;
                  DIG 1 ;
                  DUP ;
                  DUG 2 ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  PAIR ;
                  DIP { DROP 6 } }
                { DUP } ;
             DUP ;
             CAR ;
             DIG 7 ;
             DUP ;
             DUG 8 ;
             CONTRACT %updateStorage
               (pair (pair (pair (pair (big_map %address_map nat address) (big_map %allowed address bool))
                                 (pair (big_map %circles nat mutez) (big_map %key_hash_map nat key_hash)))
                           (pair (pair (big_map %nat_map nat nat) (timestamp %next_circle))
                                 (pair (mutez %reward) (big_map %shares address nat))))
                     (pair (pair (big_map %vetoVoters address nat) (big_map %vetos key_hash timestamp))
                           (pair (big_map %voters
                                    address
                                    (pair (map %allowances address bool) (option %candidate key_hash)))
                                 (big_map %votes key_hash nat)))) ;
             IF_NONE { PUSH string "01" ; FAILWITH } { DUP ; DIP { DROP } } ;
             PUSH mutez 0 ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             CDR ;
             TRANSFER_TOKENS ;
             CONS ;
             DUP ;
             DIP { DROP 9 } ;
             PAIR ;
             DIP { DROP } } ;
         DIP { DROP 2 } } }
