{ storage
    (pair (big_map %ledger address (pair (map %allowances address nat) (nat %balance)))
          (pair (address %owner) (nat %totalSupply))) ;
  parameter
    (or (or (pair %Approve (address %spender) (nat %value))
            (or (nat %Burn)
                (pair %GetAllowance (contract %contr nat) (pair (address %owner) (address %spender)))))
        (or (or (pair %GetBalance (address %account_from) (contract %contr nat))
                (contract %GetTotalSupply nat))
            (or (nat %Mint)
                (pair %Transfer (address %account_from) (pair (address %destination) (nat %value)))))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { IF_LEFT
               { SWAP ;
                 DUP ;
                 DUG 2 ;
                 CAR ;
                 SENDER ;
                 GET ;
                 IF_NONE { PUSH int 95 ; FAILWITH } { DROP } ;
                 DUP ;
                 CAR ;
                 SENDER ;
                 COMPARE ;
                 NEQ ;
                 IF { SWAP ;
                      DUP ;
                      DUG 2 ;
                      DUP ;
                      CDR ;
                      SWAP ;
                      CAR ;
                      DUP ;
                      SENDER ;
                      DUP ;
                      DUG 2 ;
                      GET ;
                      IF_NONE { PUSH int 99 ; FAILWITH } {} ;
                      DUP ;
                      CDR ;
                      SWAP ;
                      CAR ;
                      DIG 5 ;
                      CAR ;
                      DIG 6 ;
                      CAR ;
                      SENDER ;
                      GET ;
                      IF_NONE { PUSH int 96 ; FAILWITH } {} ;
                      CDR ;
                      SOME ;
                      SWAP ;
                      UPDATE ;
                      PAIR ;
                      SOME ;
                      SWAP ;
                      UPDATE ;
                      PAIR ;
                      DUP ;
                      DUP ;
                      CDR ;
                      SWAP ;
                      CAR ;
                      SENDER ;
                      DIG 3 ;
                      CAR ;
                      SENDER ;
                      GET ;
                      IF_NONE { PUSH int 98 ; FAILWITH } {} ;
                      SOME ;
                      SWAP ;
                      UPDATE ;
                      PAIR }
                    { DROP } ;
                 NIL operation }
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {}
                        { PUSH string "You must be the owner of the contract to burn tokens" ;
                          FAILWITH } ;
                     SWAP ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 3 ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                     CDR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     COMPARE ;
                     LE ;
                     IF {} { PUSH string "Owner balance is too low" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DUP ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CDR ;
                     CAR ;
                     DUP ;
                     DUG 2 ;
                     GET ;
                     IF_NONE { PUSH int 81 ; FAILWITH } {} ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     DIG 6 ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                     CDR ;
                     SUB ;
                     ISNAT ;
                     IF_NONE { PUSH int 81 ; FAILWITH } {} ;
                     SWAP ;
                     PAIR ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 3 ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                     CAR ;
                     ITER { CAR ;
                            DIG 2 ;
                            DUP ;
                            DUG 3 ;
                            DUP ;
                            CDR ;
                            SWAP ;
                            CAR ;
                            DUP ;
                            DIG 5 ;
                            DUP ;
                            DUG 6 ;
                            CDR ;
                            CAR ;
                            DUP ;
                            DUG 2 ;
                            GET ;
                            IF_NONE { PUSH int 85 ; FAILWITH } {} ;
                            DUP ;
                            CDR ;
                            SWAP ;
                            CAR ;
                            DIG 5 ;
                            DIG 7 ;
                            DUP ;
                            CAR ;
                            SWAP ;
                            DUP ;
                            DUG 9 ;
                            CDR ;
                            CAR ;
                            GET ;
                            IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                            CAR ;
                            SIZE ;
                            DIG 7 ;
                            DUP ;
                            DUG 8 ;
                            EDIV ;
                            IF_NONE { PUSH int 85 ; FAILWITH } { CAR } ;
                            DIG 8 ;
                            DUP ;
                            CAR ;
                            SWAP ;
                            CDR ;
                            CAR ;
                            GET ;
                            IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                            CAR ;
                            DIG 2 ;
                            DUP ;
                            DUG 3 ;
                            GET ;
                            IF_NONE { PUSH int 85 ; FAILWITH } {} ;
                            SUB ;
                            ISNAT ;
                            IF_NONE { PUSH int 85 ; FAILWITH } {} ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR ;
                            SWAP } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DIG 3 ;
                     DUP ;
                     CDR ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 78 ; FAILWITH } {} ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     CAR ;
                     DIG 2 ;
                     DIG 3 ;
                     CDR ;
                     CDR ;
                     SUB ;
                     ISNAT ;
                     IF_NONE { PUSH int 89 ; FAILWITH } {} ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     NIL operation }
                   { DUP ;
                     CAR ;
                     NIL operation ;
                     SWAP ;
                     PUSH mutez 0 ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 107 ; FAILWITH } {} ;
                     CAR ;
                     DIG 4 ;
                     CDR ;
                     CDR ;
                     GET ;
                     IF_NONE { PUSH int 108 ; FAILWITH } {} ;
                     TRANSFER_TOKENS ;
                     CONS } } }
           { IF_LEFT
               { IF_LEFT
                   { DUP ;
                     CDR ;
                     NIL operation ;
                     SWAP ;
                     PUSH mutez 0 ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CAR ;
                     DIG 4 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 115 ; FAILWITH } {} ;
                     CDR ;
                     TRANSFER_TOKENS ;
                     CONS }
                   { NIL operation ;
                     SWAP ;
                     PUSH mutez 0 ;
                     DIG 3 ;
                     DUP ;
                     DUG 4 ;
                     CDR ;
                     CDR ;
                     TRANSFER_TOKENS ;
                     CONS } }
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {}
                        { PUSH string "You must be the owner of the contract to mint tokens" ;
                          FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DIG 3 ;
                     DUP ;
                     CDR ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 6 ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE
                       { DIG 4 ;
                         DROP ;
                         PUSH (pair (map %allowances address nat) (nat %balance)) (Pair {} 0) }
                       { DIG 5 ; DROP } ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DUP ;
                     DIG 4 ;
                     CDR ;
                     CAR ;
                     DUP ;
                     DUG 2 ;
                     GET ;
                     IF_NONE { PUSH int 67 ; FAILWITH } {} ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     DIG 5 ;
                     DUP ;
                     DUG 6 ;
                     ADD ;
                     SWAP ;
                     PAIR ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     DIG 3 ;
                     ADD ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR }
                   { DUP ;
                     CDR ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     COMPARE ;
                     NEQ ;
                     IF {} {} ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                     CDR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CDR ;
                     COMPARE ;
                     LE ;
                     IF {} { PUSH string "Source balance is too low" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DUP ;
                     DIG 3 ;
                     DUP ;
                     DUG 4 ;
                     CAR ;
                     DUP ;
                     DUG 2 ;
                     GET ;
                     IF_NONE { PUSH int 46 ; FAILWITH } {} ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CDR ;
                     CDR ;
                     DIG 6 ;
                     CAR ;
                     DIG 6 ;
                     DUP ;
                     DUG 7 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                     CDR ;
                     SUB ;
                     ABS ;
                     SWAP ;
                     PAIR ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DIG 2 ;
                     DUP ;
                     DUG 3 ;
                     CAR ;
                     DIG 4 ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DIG 2 ;
                     DUP ;
                     DUG 3 ;
                     CDR ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CAR ;
                     DIG 4 ;
                     DUP ;
                     DUG 5 ;
                     CDR ;
                     CAR ;
                     GET ;
                     IF_NONE
                       { DIG 4 ;
                         DROP ;
                         PUSH (pair (map %allowances address nat) (nat %balance)) (Pair {} 0) }
                       { DIG 5 ; DROP } ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DUP ;
                     DIG 3 ;
                     DUP ;
                     DUG 4 ;
                     CDR ;
                     CAR ;
                     DUP ;
                     DUG 2 ;
                     GET ;
                     IF_NONE { PUSH int 51 ; FAILWITH } {} ;
                     DUP ;
                     CAR ;
                     SWAP ;
                     CDR ;
                     DIG 5 ;
                     DUP ;
                     DUG 6 ;
                     CDR ;
                     CDR ;
                     ADD ;
                     SWAP ;
                     PAIR ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                     CAR ;
                     SENDER ;
                     MEM ;
                     IF { SWAP ;
                          DUP ;
                          DUG 2 ;
                          CAR ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          CAR ;
                          GET ;
                          IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                          CAR ;
                          SENDER ;
                          GET ;
                          IF_NONE { PUSH int 53 ; FAILWITH } {} ;
                          DIG 2 ;
                          DUP ;
                          CDR ;
                          SWAP ;
                          CAR ;
                          DUP ;
                          DIG 4 ;
                          DUP ;
                          DUG 5 ;
                          CAR ;
                          DUP ;
                          DUG 2 ;
                          GET ;
                          IF_NONE { PUSH int 55 ; FAILWITH } {} ;
                          DUP ;
                          CDR ;
                          SWAP ;
                          CAR ;
                          SENDER ;
                          DIG 7 ;
                          DUP ;
                          DUG 8 ;
                          CDR ;
                          CDR ;
                          DIG 7 ;
                          SUB ;
                          ISNAT ;
                          IF_NONE { PUSH int 55 ; FAILWITH } {} ;
                          SOME ;
                          SWAP ;
                          UPDATE ;
                          PAIR ;
                          SOME ;
                          SWAP ;
                          UPDATE ;
                          PAIR ;
                          SWAP }
                        {} ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     DUP ;
                     CDR ;
                     SWAP ;
                     CAR ;
                     DIG 2 ;
                     DUP ;
                     DUG 3 ;
                     CAR ;
                     DIG 4 ;
                     CAR ;
                     DIG 4 ;
                     CAR ;
                     GET ;
                     IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                     SOME ;
                     SWAP ;
                     UPDATE ;
                     PAIR } ;
                 NIL operation } } ;
         PAIR } }
