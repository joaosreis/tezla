{ storage
    (pair (pair (pair (string %current) (int %played)) (list %rules string)) (int %verse)) ;
  parameter int ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         DUP ;
         PUSH int 0 ;
         DUP ;
         DIG 2 ;
         DUP ;
         DUG 3 ;
         COMPARE ;
         GT ;
         LOOP { DIG 3 ;
                DUP ;
                DUG 4 ;
                DUP ;
                CDR ;
                SWAP ;
                CAR ;
                DUP ;
                CDR ;
                SWAP ;
                CAR ;
                CDR ;
                PUSH string "\\n" ;
                DIG 7 ;
                DUP ;
                DUG 8 ;
                CAR ;
                CAR ;
                CAR ;
                CONCAT ;
                PAIR ;
                PAIR ;
                PAIR ;
                DUG 4 ;
                DIG 3 ;
                DROP ;
                PUSH int 1 ;
                ADD ;
                DUP ;
                DIG 2 ;
                DUP ;
                DUG 3 ;
                COMPARE ;
                GT } ;
         DROP ;
         DROP ;
         DROP ;
         NIL operation ;
         PAIR } }
