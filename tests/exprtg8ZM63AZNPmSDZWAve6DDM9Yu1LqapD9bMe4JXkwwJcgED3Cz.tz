{ parameter
    (or (pair %createAuction
           (nat %asset_token_id)
           (pair (string %auction_type) (address %fa2_contract_address)))
        (or (pair %endAuction (nat %auctionID) (address %owner))
            (pair %saveFactoryAddresses
               (address %dutch_auction_house)
               (pair (address %english_auction_house) (address %fpl_auction_house))))) ;
  storage
    (pair (pair (pair (address %administrator)
                      (big_map %auctions
                         nat
                         (pair (pair (nat %asset_token_id) (string %auction_type))
                               (pair (address %contract_address)
                                     (pair (address %fa2_contract_address) (address %owner))))))
                (pair (nat %counter) (address %dutch_auction_house)))
          (pair (pair (address %english_auction_house) (address %fpl_auction_house))
                (pair (address %reverse_auction_house)
                      (pair (address %sealed_bid_auction_house) (address %vickrey_auction_house))))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { DUP ;
             CDR ;
             CAR ;
             PUSH string "english" ;
             COMPARE ;
             EQ ;
             IF { PUSH bool True }
                { DUP ; CDR ; CAR ; PUSH string "dutch" ; COMPARE ; EQ } ;
             IF { PUSH bool True }
                { DUP ; CDR ; CAR ; PUSH string "sealed-bid" ; COMPARE ; EQ } ;
             IF { PUSH bool True }
                { DUP ; CDR ; CAR ; PUSH string "fpl" ; COMPARE ; EQ } ;
             IF {} { PUSH string "incorrect auction_type" ; FAILWITH } ;
             DUP ;
             CDR ;
             CDR ;
             CONTRACT %transfer
               (list (pair (address %from_)
                           (list %txs (pair (address %to_) (pair (nat %token_id) (nat %amount)))))) ;
             IF_NONE { PUSH int 391 ; FAILWITH } {} ;
             NIL operation ;
             SWAP ;
             PUSH mutez 0 ;
             NIL (pair (address %from_)
                       (list %txs (pair (address %to_) (pair (nat %token_id) (nat %amount))))) ;
             NIL (pair (address %to_) (pair (nat %token_id) (nat %amount))) ;
             PUSH nat 1 ;
             DIG 6 ;
             DUP ;
             DUG 7 ;
             CAR ;
             PAIR %token_id %amount ;
             SELF ;
             ADDRESS ;
             PAIR %to_ ;
             CONS ;
             SENDER ;
             PAIR %from_ %txs ;
             CONS ;
             TRANSFER_TOKENS ;
             CONS ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             DUP ;
             CDR ;
             SWAP ;
             CAR ;
             DUP ;
             CDR ;
             SWAP ;
             CAR ;
             DUP ;
             CAR ;
             SWAP ;
             CDR ;
             SENDER ;
             DIG 6 ;
             DUP ;
             DUG 7 ;
             CDR ;
             CDR ;
             PAIR %fa2_contract_address %owner ;
             SELF ;
             ADDRESS ;
             PAIR %contract_address ;
             DIG 6 ;
             DUP ;
             CDR ;
             CAR ;
             SWAP ;
             DUP ;
             DUG 8 ;
             CAR ;
             PAIR %asset_token_id %auction_type ;
             PAIR ;
             SOME ;
             DIG 7 ;
             CAR ;
             CDR ;
             CAR ;
             UPDATE ;
             SWAP ;
             PAIR ;
             PAIR ;
             PAIR ;
             DUG 2 ;
             PUSH string "dutch" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 7 ;
                  DUP ;
                  DUG 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 407 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 9 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 3 ;
                  CAR ;
                  CDR ;
                  CDR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             PUSH string "english" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 7 ;
                  DUP ;
                  DUG 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 411 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 9 ;
                  CDR ;
                  CAR ;
                  CAR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 3 ;
                  CDR ;
                  CAR ;
                  CAR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             PUSH string "sealed-bid" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 7 ;
                  DUP ;
                  DUG 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 415 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 9 ;
                  CDR ;
                  CDR ;
                  CDR ;
                  CAR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 3 ;
                  CDR ;
                  CDR ;
                  CDR ;
                  CAR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             PUSH string "vickrey" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 7 ;
                  DUP ;
                  DUG 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 419 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 9 ;
                  CDR ;
                  CDR ;
                  CDR ;
                  CDR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 3 ;
                  CDR ;
                  CDR ;
                  CDR ;
                  CDR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             PUSH string "fpl" ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 7 ;
                  DUP ;
                  DUG 8 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 423 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 9 ;
                  CDR ;
                  CAR ;
                  CDR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 3 ;
                  CDR ;
                  CAR ;
                  CDR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 5 ;
                  DUP ;
                  DUG 6 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             PUSH string "reverse" ;
             DIG 2 ;
             CDR ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { SWAP ;
                  DUP ;
                  DUG 2 ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CDR ;
                  SWAP ;
                  CAR ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  DUP ;
                  DIG 6 ;
                  DUP ;
                  DUG 7 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  DUP ;
                  DUG 2 ;
                  GET ;
                  IF_NONE { PUSH int 427 ; FAILWITH } {} ;
                  DUP ;
                  CAR ;
                  SWAP ;
                  CDR ;
                  CDR ;
                  DIG 8 ;
                  CDR ;
                  CDR ;
                  CAR ;
                  PAIR ;
                  SWAP ;
                  PAIR ;
                  SOME ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  PAIR ;
                  PAIR ;
                  PAIR ;
                  DUP ;
                  DUG 2 ;
                  CDR ;
                  CDR ;
                  CAR ;
                  CONTRACT %createAuction (pair (nat %auctionID) (address %owner)) ;
                  IF_NONE { PUSH int 446 ; FAILWITH } {} ;
                  PUSH mutez 0 ;
                  SENDER ;
                  DIG 4 ;
                  DUP ;
                  DUG 5 ;
                  CAR ;
                  CDR ;
                  CAR ;
                  PAIR %auctionID %owner ;
                  TRANSFER_TOKENS ;
                  CONS }
                {} ;
             SWAP ;
             DUP ;
             CDR ;
             SWAP ;
             CAR ;
             DUP ;
             CAR ;
             SWAP ;
             CDR ;
             DUP ;
             CDR ;
             SWAP ;
             CAR ;
             PUSH nat 1 ;
             ADD ;
             PAIR ;
             SWAP ;
             PAIR ;
             PAIR ;
             SWAP }
           { IF_LEFT
               { SWAP ;
                 DUP ;
                 DUG 2 ;
                 CAR ;
                 CAR ;
                 CDR ;
                 SWAP ;
                 DUP ;
                 DUG 2 ;
                 CAR ;
                 GET ;
                 IF_NONE { PUSH int 436 ; FAILWITH } {} ;
                 CDR ;
                 CAR ;
                 SENDER ;
                 COMPARE ;
                 EQ ;
                 IF {}
                    { PUSH string
                           "WrongCondition: sp.sender == self.data.auctions[params.auctionID].contract_address" ;
                      FAILWITH } ;
                 NIL operation ;
                 DIG 2 ;
                 DUP ;
                 DUG 3 ;
                 CAR ;
                 CAR ;
                 CDR ;
                 DIG 2 ;
                 DUP ;
                 DUG 3 ;
                 CAR ;
                 GET ;
                 IF_NONE { PUSH int 438 ; FAILWITH } {} ;
                 CDR ;
                 CDR ;
                 CAR ;
                 CONTRACT %transfer
                   (list (pair (address %from_)
                               (list %txs (pair (address %to_) (pair (nat %token_id) (nat %amount)))))) ;
                 IF_NONE { PUSH int 438 ; FAILWITH } {} ;
                 PUSH mutez 0 ;
                 NIL (pair (address %from_)
                           (list %txs (pair (address %to_) (pair (nat %token_id) (nat %amount))))) ;
                 NIL (pair (address %to_) (pair (nat %token_id) (nat %amount))) ;
                 PUSH nat 1 ;
                 DIG 7 ;
                 DUP ;
                 DUG 8 ;
                 CAR ;
                 CAR ;
                 CDR ;
                 DIG 7 ;
                 DUP ;
                 DUG 8 ;
                 CAR ;
                 GET ;
                 IF_NONE { PUSH int 440 ; FAILWITH } {} ;
                 CAR ;
                 CAR ;
                 PAIR %token_id %amount ;
                 DIG 6 ;
                 CDR ;
                 PAIR %to_ ;
                 CONS ;
                 SELF ;
                 ADDRESS ;
                 PAIR %from_ %txs ;
                 CONS ;
                 TRANSFER_TOKENS ;
                 CONS }
               { SWAP ;
                 DUP ;
                 DUG 2 ;
                 CAR ;
                 CAR ;
                 CAR ;
                 SENDER ;
                 COMPARE ;
                 EQ ;
                 IF {}
                    { PUSH string "WrongCondition: sp.sender == self.data.administrator" ;
                      FAILWITH } ;
                 SWAP ;
                 DUP ;
                 CAR ;
                 SWAP ;
                 CDR ;
                 DUP ;
                 CDR ;
                 SWAP ;
                 CAR ;
                 CDR ;
                 DIG 3 ;
                 DUP ;
                 DUG 4 ;
                 CDR ;
                 CAR ;
                 PAIR ;
                 PAIR ;
                 SWAP ;
                 PAIR ;
                 DUP ;
                 CDR ;
                 SWAP ;
                 CAR ;
                 DUP ;
                 CAR ;
                 SWAP ;
                 CDR ;
                 CAR ;
                 DIG 3 ;
                 DUP ;
                 DUG 4 ;
                 CAR ;
                 SWAP ;
                 PAIR ;
                 SWAP ;
                 PAIR ;
                 PAIR ;
                 DUP ;
                 CAR ;
                 SWAP ;
                 CDR ;
                 DUP ;
                 CDR ;
                 SWAP ;
                 CAR ;
                 CAR ;
                 DIG 3 ;
                 CDR ;
                 CDR ;
                 SWAP ;
                 PAIR ;
                 PAIR ;
                 SWAP ;
                 PAIR ;
                 NIL operation } } ;
         NIL operation ;
         SWAP ;
         ITER { CONS } ;
         PAIR } }
