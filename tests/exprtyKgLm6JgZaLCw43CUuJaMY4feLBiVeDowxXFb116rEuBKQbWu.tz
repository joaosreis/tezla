{ parameter (or (or (string %addTodo) (nat %markAsDone)) (nat %removeTodo)) ;
  storage
    (pair (pair (address %admin) (big_map %done_todos nat (pair timestamp string)))
          (pair (nat %last_todo_id) (set %set_of_todos (pair nat string)))) ;
  code { LAMBDA
           (pair nat (set (pair nat string)))
           (pair nat string)
           { UNPAIR ;
             PUSH string "" ;
             PUSH nat 0 ;
             PAIR ;
             DIG 2 ;
             ITER { SWAP ;
                    DUP 3 ;
                    DUP 3 ;
                    CAR ;
                    COMPARE ;
                    EQ ;
                    IF { DROP } { SWAP ; DROP } } ;
             SWAP ;
             DROP ;
             PUSH nat 0 ;
             SWAP ;
             DUP ;
             DUG 2 ;
             CAR ;
             COMPARE ;
             EQ ;
             IF { DROP ; PUSH string "ERROR" ; FAILWITH } {} } ;
         SWAP ;
         UNPAIR ;
         SWAP ;
         DUP ;
         DUG 2 ;
         CAR ;
         CAR ;
         SENDER ;
         COMPARE ;
         NEQ ;
         IF { DROP 3 ; PUSH string "UNKNOWN_SENDER" ; FAILWITH }
            { IF_LEFT
                { IF_LEFT
                    { DIG 2 ;
                      DROP ;
                      PUSH nat 1 ;
                      DUP 3 ;
                      CDR ;
                      CAR ;
                      ADD ;
                      DUP 3 ;
                      CDR ;
                      CDR ;
                      DUG 2 ;
                      DUP ;
                      DUG 3 ;
                      PAIR ;
                      PUSH bool True ;
                      SWAP ;
                      UPDATE ;
                      DUP 3 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      DIG 2 ;
                      CAR ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      CDR ;
                      DIG 2 ;
                      PAIR ;
                      SWAP ;
                      CAR ;
                      PAIR }
                    { SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      CDR ;
                      SWAP ;
                      PAIR ;
                      DIG 2 ;
                      SWAP ;
                      EXEC ;
                      UNPAIR ;
                      DUP 3 ;
                      CDR ;
                      CDR ;
                      DUP 3 ;
                      DUP 3 ;
                      PAIR ;
                      PUSH bool False ;
                      SWAP ;
                      UPDATE ;
                      DUP 4 ;
                      CDR ;
                      CAR ;
                      PAIR ;
                      DUP 4 ;
                      CAR ;
                      PAIR ;
                      DUP ;
                      CDR ;
                      DIG 4 ;
                      CAR ;
                      CDR ;
                      DIG 4 ;
                      NOW ;
                      PAIR ;
                      DIG 4 ;
                      SWAP ;
                      SOME ;
                      SWAP ;
                      UPDATE ;
                      DIG 2 ;
                      CAR ;
                      CAR ;
                      PAIR ;
                      PAIR } }
                { SWAP ;
                  DUP ;
                  DUG 2 ;
                  CDR ;
                  CDR ;
                  SWAP ;
                  PAIR ;
                  DIG 2 ;
                  SWAP ;
                  EXEC ;
                  SWAP ;
                  DUP ;
                  DUG 2 ;
                  CDR ;
                  CDR ;
                  SWAP ;
                  PUSH bool False ;
                  SWAP ;
                  UPDATE ;
                  SWAP ;
                  DUP ;
                  DUG 2 ;
                  CDR ;
                  CAR ;
                  PAIR ;
                  SWAP ;
                  CAR ;
                  PAIR } ;
              NIL operation ;
              PAIR } } }
