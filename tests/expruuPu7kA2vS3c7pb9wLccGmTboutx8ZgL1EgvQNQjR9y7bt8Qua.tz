{ parameter
    (or (or (or (string %burn)
                (or (pair %fa12purchase
                       (pair (nat %amount) (address %buyer))
                       (pair (address %owner) (string %tokenId)))
                    (pair %getAdministrator unit (contract address))))
            (or (or (pair %getOwner string (contract address))
                    (pair %getTotalTokens unit (contract int)))
                (or (pair %mint
                       (pair (option %contractAddr address)
                             (pair (option %metaData (map string string)) (bool %onSale)))
                       (pair (pair (address %owner) (option %receiver address))
                             (pair (string %tokenId) (nat %value))))
                    (string %purchase))))
        (or (or (or (address %removeFA12) (address %setAdministrator))
                (or (bool %setPause)
                    (pair %setSale
                       (pair (option %contractAddr address) (option %receiver address))
                       (pair (bool %sale) (pair (string %tokenId) (nat %value))))))
            (or (or (pair %transfer (string %tokenId) (pair (address %from) (address %to)))
                    (pair %transferFunds (mutez %amount) (address %receiver)))
                (or (nat %updateSplit) (address %whitelistFA12))))) ;
  storage
    (pair (pair (address %administrator) (pair (set %authFA12 address) (int %nbTokens)))
          (pair (bool %paused)
                (pair (nat %sellerSplit)
                      (big_map %tokens
                         string
                         (pair (pair (map %approvals address nat)
                                     (pair (option %contractAddr address) (map %metaData string string)))
                               (pair (pair (bool %onSale) (address %owner))
                                     (pair (option %receiver address) (nat %value)))))))) ;
  code { UNPAIR ;
         IF_LEFT
           { IF_LEFT
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 6 ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     MEM ;
                     IF {} { PUSH string "Unreferenced token" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 6 ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET ;
                     { IF_NONE { PUSH int 11 ; FAILWITH } {} } ;
                     GET 3 ;
                     CDR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {} { PUSH string "Only owner allowed" ; FAILWITH } ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     NONE (pair (pair (map %approvals address nat)
                                      (pair (option %contractAddr address) (map %metaData string string)))
                                (pair (pair (bool %onSale) (address %owner))
                                      (pair (option %receiver address) (nat %value)))) ;
                     DIG 5 ;
                     UPDATE ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     PUSH int 1 ;
                     SWAP ;
                     SUB ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     NIL operation }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 3 ;
                         IF { PUSH string "Contract is paused" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SENDER ;
                         MEM ;
                         IF {} { PUSH string "FA12 not whitelisted" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         MEM ;
                         IF {} { PUSH string "Unreferenced token" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         GET ;
                         { IF_NONE { PUSH int 139 ; FAILWITH } {} } ;
                         GET 3 ;
                         CAR ;
                         IF {} { PUSH string "Not on sale" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         GET ;
                         { IF_NONE { PUSH int 140 ; FAILWITH } {} } ;
                         CAR ;
                         GET 3 ;
                         { IF_NONE
                             {}
                             { DROP ;
                               SENDER ;
                               DUP 3 ;
                               GET 6 ;
                               DUP 3 ;
                               GET 4 ;
                               GET ;
                               { IF_NONE { PUSH int 141 ; FAILWITH } {} } ;
                               CAR ;
                               GET 3 ;
                               { IF_NONE { PUSH int 141 ; FAILWITH } {} } ;
                               COMPARE ;
                               EQ ;
                               IF {} { PUSH string "Not allowed for this contract" ; FAILWITH } } } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         GET ;
                         { IF_NONE { PUSH int 11 ; FAILWITH } {} } ;
                         GET 3 ;
                         CDR ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 3 ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only payable to owner" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         GET ;
                         { IF_NONE { PUSH int 143 ; FAILWITH } {} } ;
                         GET 5 ;
                         { IF_NONE
                             {}
                             { DROP ;
                               DUP ;
                               CAR ;
                               CDR ;
                               DUP 3 ;
                               GET 6 ;
                               DUP 3 ;
                               GET 4 ;
                               GET ;
                               { IF_NONE { PUSH int 144 ; FAILWITH } {} } ;
                               GET 5 ;
                               { IF_NONE { PUSH int 144 ; FAILWITH } {} } ;
                               COMPARE ;
                               EQ ;
                               IF {} { PUSH string "Not on sale for this account" ; FAILWITH } } } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 4 ;
                         GET ;
                         { IF_NONE { PUSH int 145 ; FAILWITH } {} } ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         COMPARE ;
                         GE ;
                         IF {} { PUSH string "Not enough funds" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP ;
                         DUP 6 ;
                         GET 4 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 146 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CAR ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DIG 5 ;
                         GET 4 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 147 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CDR ;
                         PUSH bool False ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         NIL operation }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         NIL operation ;
                         DIG 2 ;
                         CDR ;
                         PUSH mutez 0 ;
                         DIG 3 ;
                         TRANSFER_TOKENS ;
                         CONS } } }
               { IF_LEFT
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET ;
                         { IF_NONE { PUSH int 56 ; FAILWITH } {} } ;
                         GET 3 ;
                         CDR ;
                         NIL operation ;
                         DIG 2 ;
                         CDR ;
                         PUSH mutez 0 ;
                         DIG 3 ;
                         TRANSFER_TOKENS ;
                         CONS }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 4 ;
                         NIL operation ;
                         DIG 2 ;
                         CDR ;
                         PUSH mutez 0 ;
                         DIG 3 ;
                         TRANSFER_TOKENS ;
                         CONS } }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 5 ;
                         MEM ;
                         IF { PUSH string "Already referenced token" ; FAILWITH } {} ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP 5 ;
                         GET 6 ;
                         NONE address ;
                         PAIR %receiver %value ;
                         DIG 5 ;
                         DUP ;
                         GET 3 ;
                         CAR ;
                         SWAP ;
                         DUP ;
                         DUG 7 ;
                         CAR ;
                         GET 4 ;
                         PAIR %onSale %owner ;
                         PAIR ;
                         EMPTY_MAP string string ;
                         DUP 7 ;
                         CAR ;
                         CAR ;
                         PAIR %contractAddr %metaData ;
                         EMPTY_MAP address nat ;
                         PAIR %approvals ;
                         PAIR ;
                         SOME ;
                         DUP 6 ;
                         GET 5 ;
                         UPDATE ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         DUP ;
                         CAR ;
                         GET 3 ;
                         { IF_NONE
                             { DROP }
                             { DROP ;
                               DUP ;
                               CAR ;
                               GET 3 ;
                               { IF_NONE { PUSH int 70 ; FAILWITH } {} } ;
                               ITER { CAR ;
                                      DIG 2 ;
                                      UNPAIR ;
                                      SWAP ;
                                      UNPAIR ;
                                      SWAP ;
                                      UNPAIR ;
                                      SWAP ;
                                      DUP ;
                                      DUP 7 ;
                                      GET 5 ;
                                      DUP ;
                                      DUG 2 ;
                                      GET ;
                                      { IF_NONE { PUSH int 71 ; FAILWITH } {} } ;
                                      UNPAIR ;
                                      UNPAIR ;
                                      SWAP ;
                                      UNPAIR ;
                                      SWAP ;
                                      DUP 11 ;
                                      CAR ;
                                      GET 3 ;
                                      { IF_NONE { PUSH int 70 ; FAILWITH } {} } ;
                                      DUP 11 ;
                                      GET ;
                                      { IF_NONE { PUSH int 71 ; FAILWITH } {} } ;
                                      SOME ;
                                      DIG 10 ;
                                      UPDATE ;
                                      SWAP ;
                                      PAIR ;
                                      SWAP ;
                                      PAIR ;
                                      PAIR ;
                                      SOME ;
                                      SWAP ;
                                      UPDATE ;
                                      SWAP ;
                                      PAIR ;
                                      SWAP ;
                                      PAIR ;
                                      SWAP ;
                                      PAIR ;
                                      SWAP } ;
                               DROP } } ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         PUSH int 1 ;
                         ADD ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         NIL operation }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 3 ;
                         IF { PUSH string "Contract is paused" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         MEM ;
                         IF {} { PUSH string "Unreferenced token" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 40 ; FAILWITH } {} } ;
                         GET 3 ;
                         CAR ;
                         IF {} { PUSH string "Not on sale" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 42 ; FAILWITH } {} } ;
                         CAR ;
                         GET 3 ;
                         { IF_NONE {} { PUSH string "Not allowed for XTZ funds" ; FAILWITH } } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 43 ; FAILWITH } {} } ;
                         GET 5 ;
                         { IF_NONE
                             {}
                             { DROP ;
                               SENDER ;
                               DUP 3 ;
                               GET 6 ;
                               DUP 3 ;
                               GET ;
                               { IF_NONE { PUSH int 44 ; FAILWITH } {} } ;
                               GET 5 ;
                               { IF_NONE { PUSH int 44 ; FAILWITH } {} } ;
                               COMPARE ;
                               EQ ;
                               IF {} { PUSH string "Not on sale for this account" ; FAILWITH } } } ;
                         PUSH mutez 1 ;
                         DUP 3 ;
                         GET 6 ;
                         DUP 3 ;
                         GET ;
                         { IF_NONE { PUSH int 45 ; FAILWITH } {} } ;
                         GET 6 ;
                         MUL ;
                         AMOUNT ;
                         COMPARE ;
                         GE ;
                         IF {} { PUSH string "Not enough funds" ; FAILWITH } ;
                         NIL operation ;
                         DUP 3 ;
                         GET 6 ;
                         DUP 3 ;
                         GET ;
                         { IF_NONE { PUSH int 48 ; FAILWITH } {} } ;
                         GET 3 ;
                         CDR ;
                         CONTRACT unit ;
                         { IF_NONE { PUSH int 48 ; FAILWITH } {} } ;
                         PUSH nat 1000 ;
                         AMOUNT ;
                         DUP 6 ;
                         GET 5 ;
                         MUL ;
                         EDIV ;
                         { IF_NONE { PUSH int 47 ; FAILWITH } {} } ;
                         CAR ;
                         UNIT ;
                         TRANSFER_TOKENS ;
                         CONS ;
                         DIG 2 ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP ;
                         DUP 7 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 49 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CAR ;
                         SENDER ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DIG 6 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 50 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CDR ;
                         PUSH bool False ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP } } } }
           { IF_LEFT
               { IF_LEFT
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH bool False ;
                         DIG 5 ;
                         UPDATE ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         CDR ;
                         DIG 2 ;
                         PAIR ;
                         PAIR } }
                   { IF_LEFT
                       { DROP ;
                         DUP ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 3 ;
                         IF { PUSH string "Contract is paused" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 5 ;
                         MEM ;
                         IF {} { PUSH string "Unreferenced token" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 5 ;
                         GET ;
                         { IF_NONE { PUSH int 11 ; FAILWITH } {} } ;
                         GET 3 ;
                         CDR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only owner allowed" ; FAILWITH } ;
                         DUP ;
                         CAR ;
                         CAR ;
                         { IF_NONE
                             {}
                             { DROP ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CAR ;
                               GET 3 ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CAR ;
                               CAR ;
                               { IF_NONE { PUSH int 20 ; FAILWITH } {} } ;
                               MEM ;
                               IF {} { PUSH string "FA12 not whitelisted" ; FAILWITH } } } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP ;
                         DUP 6 ;
                         GET 5 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 21 ; FAILWITH } {} } ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         DUP 9 ;
                         CAR ;
                         CAR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DUP 6 ;
                         GET 5 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 22 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CDR ;
                         DUP 9 ;
                         GET 3 ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DUP 6 ;
                         GET 5 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 23 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CAR ;
                         DUP 9 ;
                         GET 6 ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DUP 6 ;
                         GET 5 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 24 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         DUP ;
                         DUP 6 ;
                         GET 5 ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 25 ; FAILWITH } {} } ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         DIG 8 ;
                         CAR ;
                         CAR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR } } ;
                 NIL operation }
               { IF_LEFT
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 3 ;
                         IF { PUSH string "Contract is paused" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         MEM ;
                         IF {} { PUSH string "Unreferenced token" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET ;
                         { IF_NONE { PUSH int 11 ; FAILWITH } {} } ;
                         GET 3 ;
                         CDR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only owner allowed" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP ;
                         DUP 6 ;
                         CAR ;
                         DUP ;
                         DUG 2 ;
                         GET ;
                         { IF_NONE { PUSH int 33 ; FAILWITH } {} } ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         CAR ;
                         DIG 8 ;
                         GET 4 ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SOME ;
                         SWAP ;
                         UPDATE ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         NIL operation }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } ;
                         DUP ;
                         CDR ;
                         CONTRACT unit ;
                         { IF_NONE { PUSH int 96 ; FAILWITH } {} } ;
                         NIL operation ;
                         SWAP ;
                         DIG 2 ;
                         CAR ;
                         UNIT ;
                         TRANSFER_TOKENS ;
                         CONS } }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         DIG 3 ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "Only administrator allowed" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         MEM ;
                         IF { PUSH string "Contract already whitelisted" ; FAILWITH } {} ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH bool True ;
                         DIG 5 ;
                         UPDATE ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR } ;
                     NIL operation } } } ;
         PAIR } }
