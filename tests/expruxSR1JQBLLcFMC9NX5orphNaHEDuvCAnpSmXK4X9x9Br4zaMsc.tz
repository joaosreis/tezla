{ parameter
    (or (pair %createBet (nat %number) (nat %seed))
        (pair %realiseBet (int %bet) (pair (nat %number) (int %seed)))) ;
  storage
    (pair (int %bet)
          (pair (map %idToBet int (pair (address %creator) (pair (nat %number) (nat %seed))))
                (address %owner))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { PUSH mutez 500000 ;
             AMOUNT ;
             COMPARE ;
             EQ ;
             IF {} { PUSH string "Wrong amount sent" ; FAILWITH } ;
             DUP ;
             CAR ;
             PUSH nat 0 ;
             COMPARE ;
             LT ;
             IF {} { PUSH string "Wrong Bet Number" ; FAILWITH } ;
             DUP ;
             CAR ;
             PUSH nat 100 ;
             COMPARE ;
             GT ;
             IF {} { PUSH string "Wrong Bet Number" ; FAILWITH } ;
             SWAP ;
             DUP ;
             DUG 2 ;
             DUP ;
             CAR ;
             SWAP ;
             CDR ;
             DUP ;
             CDR ;
             SWAP ;
             CAR ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             CDR ;
             DIG 4 ;
             CAR ;
             PAIR %number %seed ;
             SENDER ;
             PAIR %creator ;
             SOME ;
             DIG 4 ;
             CAR ;
             UPDATE ;
             PAIR ;
             SWAP ;
             PAIR ;
             DUP ;
             CDR ;
             PUSH int 1 ;
             DIG 2 ;
             CAR ;
             ADD ;
             PAIR ;
             NIL operation }
           { PUSH mutez 500000 ;
             AMOUNT ;
             COMPARE ;
             EQ ;
             IF {} { PUSH string "Wrong amount sent" ; FAILWITH } ;
             DUP ;
             { CDR ; CAR } ;
             PUSH nat 0 ;
             COMPARE ;
             LT ;
             IF {} { PUSH string "Wrong bet number" ; FAILWITH } ;
             DUP ;
             { CDR ; CAR } ;
             PUSH nat 100 ;
             COMPARE ;
             GT ;
             IF {} { PUSH string "Wrong bet number" ; FAILWITH } ;
             SWAP ;
             DUP ;
             DUG 2 ;
             CAR ;
             SWAP ;
             DUP ;
             DUG 2 ;
             CAR ;
             COMPARE ;
             LT ;
             IF {} { PUSH string "Invalid BET ID" ; FAILWITH } ;
             DUP ;
             CAR ;
             PUSH int 0 ;
             COMPARE ;
             LT ;
             IF {} { PUSH string "Invalid BET ID" ; FAILWITH } ;
             DUP ;
             { CDR ; CAR } ;
             PUSH nat 100 ;
             PUSH int 100 ;
             DIG 3 ;
             DUP ;
             DUG 4 ;
             { CDR ; CDR } ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             PUSH nat 100 ;
             DIG 5 ;
             DUP ;
             DUG 6 ;
             { CDR ; CAR } ;
             DIG 5 ;
             DUP ;
             DUG 6 ;
             CAR ;
             GET ;
             { IF_NONE { PUSH string "Get-item:31" ; FAILWITH } {} } ;
             { CDR ; CDR } ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             ADD ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             SUB ;
             ABS ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             { CDR ; CAR } ;
             DIG 2 ;
             DUP ;
             DUG 3 ;
             CAR ;
             GET ;
             { IF_NONE { PUSH string "Get-item:31" ; FAILWITH } {} } ;
             { CDR ; CAR } ;
             PUSH nat 100 ;
             PUSH int 100 ;
             DIG 4 ;
             DUP ;
             DUG 5 ;
             { CDR ; CDR } ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             PUSH nat 100 ;
             DIG 6 ;
             DUP ;
             DUG 7 ;
             { CDR ; CAR } ;
             DIG 6 ;
             DUP ;
             DUG 7 ;
             CAR ;
             GET ;
             { IF_NONE { PUSH string "Get-item:31" ; FAILWITH } {} } ;
             { CDR ; CDR } ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             ADD ;
             EDIV ;
             { IF_NONE { PUSH string "division by zero" ; FAILWITH } { CDR } } ;
             SUB ;
             ABS ;
             COMPARE ;
             LT ;
             IF { NIL operation ;
                  DIG 2 ;
                  DUP ;
                  DUG 3 ;
                  { CDR ; CAR } ;
                  DIG 2 ;
                  CAR ;
                  GET ;
                  { IF_NONE { PUSH string "Get-item:31" ; FAILWITH } {} } ;
                  CAR ;
                  CONTRACT unit ;
                  { IF_NONE { UNIT ; FAILWITH } {} } ;
                  PUSH mutez 1000000 ;
                  UNIT ;
                  TRANSFER_TOKENS ;
                  CONS }
                { DROP ;
                  NIL operation ;
                  SENDER ;
                  CONTRACT unit ;
                  { IF_NONE { UNIT ; FAILWITH } {} } ;
                  PUSH mutez 1000000 ;
                  UNIT ;
                  TRANSFER_TOKENS ;
                  CONS } } ;
         PAIR } }
