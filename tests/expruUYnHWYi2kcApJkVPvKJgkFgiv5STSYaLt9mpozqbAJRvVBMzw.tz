{ storage
    (pair (pair (pair (string %current) (int %played)) (list %rules string)) (int %verse)) ;
  parameter int ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         DUP ;
         PUSH int 0 ;
         DUP ;
         DIG 2 ;
         DUP ;
         DUG 3 ;
         COMPARE ;
         GT ;
         LOOP { PUSH int 16 ;
                DIG 4 ;
                DUP ;
                DUG 5 ;
                CDR ;
                COMPARE ;
                EQ ;
                IF { { DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       CAR ;
                       PUSH int 1 ;
                       DIG 7 ;
                       DUP ;
                       DUG 8 ;
                       CAR ;
                       CAR ;
                       CDR ;
                       ADD ;
                       SWAP ;
                       PAIR ;
                       PAIR ;
                       PAIR ;
                       DUG 4 ;
                       DIG 3 ;
                       DROP ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       CDR ;
                       PUSH string "" ;
                       PAIR ;
                       PAIR ;
                       PAIR ;
                       DUG 4 ;
                       DIG 3 ;
                       DROP ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       CAR ;
                       PUSH int 0 ;
                       SWAP ;
                       PAIR ;
                       DUG 4 ;
                       DIG 3 ;
                       DROP } }
                   { {} } ;
                PUSH string "" ;
                DIG 4 ;
                DUP ;
                DUG 5 ;
                CAR ;
                CAR ;
                CAR ;
                COMPARE ;
                NEQ ;
                IF { { DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       CDR ;
                       PUSH string "" ;
                       DIG 7 ;
                       DUP ;
                       DUG 8 ;
                       CAR ;
                       CAR ;
                       CAR ;
                       CONCAT ;
                       PAIR ;
                       PAIR ;
                       PAIR ;
                       DUG 4 ;
                       DIG 3 ;
                       DROP } }
                   { {} } ;
                PUSH (map int string)
                     { Elt 0 "Dashing through the snow" ;
                       Elt 1 "In a one-horse open sleigh" ;
                       Elt 2 "O'er the fields we go" ;
                       Elt 3 "Laughing all the way" ;
                       Elt 4 "Bells on bob tail ring" ;
                       Elt 5 "Making spirits bright" ;
                       Elt 6 "What fun it is to ride and sing" ;
                       Elt 7 "A sleighing song tonight!" ;
                       Elt 8 "Jingle bells, jingle bells, " ;
                       Elt 9 "Jingle all the way." ;
                       Elt 10 "Oh! what fun it is to ride" ;
                       Elt 11 "In a one-horse open sleigh." ;
                       Elt 12 "Jingle bells, jingle bells, " ;
                       Elt 13 "Jingle all the way;" ;
                       Elt 14 "Oh! what fun it is to ride" ;
                       Elt 15 "In a one-horse open sleigh." } ;
                DIG 4 ;
                DUP ;
                DUG 5 ;
                DUP ;
                CDR ;
                SWAP ;
                CAR ;
                DUP ;
                CDR ;
                SWAP ;
                CAR ;
                CDR ;
                DIG 3 ;
                DUP ;
                DUG 4 ;
                DIG 8 ;
                DUP ;
                DUG 9 ;
                CDR ;
                GET ;
                IF_NONE { { PUSH unit Unit ; FAILWITH } } { {} } ;
                DIG 8 ;
                DUP ;
                DUG 9 ;
                CAR ;
                CAR ;
                CAR ;
                CONCAT ;
                PAIR ;
                PAIR ;
                PAIR ;
                DUG 5 ;
                DIG 4 ;
                DROP ;
                DIG 4 ;
                DUP ;
                DUG 5 ;
                CAR ;
                PUSH int 1 ;
                DIG 6 ;
                DUP ;
                DUG 7 ;
                CDR ;
                ADD ;
                SWAP ;
                PAIR ;
                DUG 5 ;
                DROP ;
                DIG 3 ;
                DROP ;
                PUSH int 1 ;
                ADD ;
                DUP ;
                DIG 2 ;
                DUP ;
                DUG 3 ;
                COMPARE ;
                GT } ;
         DROP ;
         DROP ;
         DROP ;
         NIL operation ;
         PAIR } }
