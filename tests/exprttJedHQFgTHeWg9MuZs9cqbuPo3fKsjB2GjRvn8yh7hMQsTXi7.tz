{ storage (option address) ;
  parameter unit ;
  code { DROP ;
         PUSH nat 0 ;
         EMPTY_BIG_MAP address (pair (map %approvals address nat) (nat %balance)) ;
         PAIR %ledger %totalSupply ;
         PUSH mutez 0 ;
         NONE key_hash ;
         CREATE_CONTRACT
           { parameter
               (or (pair %burn (address %address) (nat %value))
                   (or (pair %mint (address %address) (nat %value))
                       (pair %transfer (address %from) (pair (address %to) (nat %value))))) ;
             storage
               (pair (big_map %ledger address (pair (map %approvals address nat) (nat %balance)))
                     (nat %totalSupply)) ;
             code { UNPAIR ;
                    IF_LEFT
                      { DUP ;
                        CDR ;
                        DUP 3 ;
                        CAR ;
                        DUP 3 ;
                        CAR ;
                        GET ;
                        IF_NONE { PUSH int 36 ; FAILWITH } {} ;
                        CDR ;
                        COMPARE ;
                        GE ;
                        IF {}
                           { PUSH string
                                  "WrongCondition: self.data.ledger[params.address].balance >= params.value" ;
                             FAILWITH } ;
                        SWAP ;
                        DUP ;
                        DUG 2 ;
                        UNPAIR ;
                        DUP ;
                        DUP 4 ;
                        CAR ;
                        DUP ;
                        DUG 2 ;
                        GET ;
                        IF_NONE { PUSH int 37 ; FAILWITH } {} ;
                        CAR ;
                        DUP 5 ;
                        CDR ;
                        DIG 6 ;
                        CAR ;
                        DUP 7 ;
                        CAR ;
                        GET ;
                        IF_NONE { PUSH int 37 ; FAILWITH } {} ;
                        CDR ;
                        SUB ;
                        ISNAT ;
                        IF_NONE { PUSH int 37 ; FAILWITH } {} ;
                        SWAP ;
                        PAIR ;
                        SOME ;
                        SWAP ;
                        UPDATE ;
                        PAIR ;
                        DUP ;
                        DUG 2 ;
                        CAR ;
                        SWAP ;
                        CDR ;
                        DIG 2 ;
                        CDR ;
                        SUB ;
                        ISNAT ;
                        IF_NONE { PUSH int 38 ; FAILWITH } {} ;
                        SWAP ;
                        PAIR }
                      { IF_LEFT
                          { SWAP ;
                            UNPAIR ;
                            DUP ;
                            DUP 4 ;
                            CAR ;
                            DUP ;
                            DUG 2 ;
                            GET ;
                            IF_NONE { PUSH int 30 ; FAILWITH } {} ;
                            UNPAIR ;
                            SWAP ;
                            DUP 6 ;
                            CDR ;
                            ADD ;
                            SWAP ;
                            PAIR ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR ;
                            UNPAIR ;
                            SWAP ;
                            DIG 2 ;
                            CDR ;
                            ADD ;
                            SWAP ;
                            PAIR }
                          { DUP ;
                            GET 4 ;
                            DUP 3 ;
                            CAR ;
                            DUP 3 ;
                            CAR ;
                            GET ;
                            IF_NONE { PUSH int 20 ; FAILWITH } {} ;
                            CDR ;
                            COMPARE ;
                            GE ;
                            IF {}
                               { PUSH string
                                      "WrongCondition: self.data.ledger[params.from_].balance >= params.value" ;
                                 FAILWITH } ;
                            SWAP ;
                            DUP ;
                            DUG 2 ;
                            UNPAIR ;
                            DUP ;
                            DUP 4 ;
                            CAR ;
                            DUP ;
                            DUG 2 ;
                            GET ;
                            IF_NONE { PUSH int 21 ; FAILWITH } {} ;
                            CAR ;
                            DUP 5 ;
                            GET 4 ;
                            DIG 6 ;
                            CAR ;
                            DUP 7 ;
                            CAR ;
                            GET ;
                            IF_NONE { PUSH int 21 ; FAILWITH } {} ;
                            CDR ;
                            SUB ;
                            ISNAT ;
                            IF_NONE { PUSH int 21 ; FAILWITH } {} ;
                            SWAP ;
                            PAIR ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR ;
                            UNPAIR ;
                            DUP ;
                            DUP 4 ;
                            GET 3 ;
                            DUP ;
                            DUG 2 ;
                            GET ;
                            IF_NONE { PUSH int 22 ; FAILWITH } {} ;
                            UNPAIR ;
                            SWAP ;
                            DUP 6 ;
                            GET 4 ;
                            ADD ;
                            SWAP ;
                            PAIR ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR ;
                            DUP ;
                            DUG 2 ;
                            UNPAIR ;
                            DUP ;
                            DUP 4 ;
                            CAR ;
                            DUP ;
                            DUG 2 ;
                            GET ;
                            IF_NONE { PUSH int 23 ; FAILWITH } {} ;
                            UNPAIR ;
                            DUP 6 ;
                            GET 4 ;
                            DIG 7 ;
                            CAR ;
                            DIG 7 ;
                            CAR ;
                            GET ;
                            IF_NONE { PUSH int 23 ; FAILWITH } {} ;
                            CAR ;
                            SENDER ;
                            GET ;
                            IF_NONE { PUSH int 23 ; FAILWITH } {} ;
                            SUB ;
                            ISNAT ;
                            IF_NONE { PUSH int 23 ; FAILWITH } {} ;
                            SOME ;
                            SENDER ;
                            UPDATE ;
                            PAIR ;
                            SOME ;
                            SWAP ;
                            UPDATE ;
                            PAIR } } ;
                    NIL operation ;
                    PAIR } } ;
         PAIR ;
         CAR ;
         NIL operation ;
         SWAP ;
         CONS ;
         NONE address ;
         SWAP ;
         PAIR } }
