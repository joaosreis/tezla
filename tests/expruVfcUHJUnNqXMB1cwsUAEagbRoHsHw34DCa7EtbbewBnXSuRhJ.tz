{ parameter
    (or (or (or (unit %ExerciseSecurity) (or (nat %IncreaseCollateral) (nat %IncreaseLoan)))
            (or (unit %LiquidatedReward)
                (or (pair %OpenLoan (nat %amount) (nat %loan))
                    (pair %OracleLiquidate
                       (pair (address %address) (nat %penality))
                       (nat %price)
                       (nat %ratio)
                       (nat %stabilityFees)))))
        (or (or (pair %PurchaseSecurity (nat %duration) (nat %order) (address %securityDelegator))
                (or (pair %Repay (nat %Operation) (nat %amount)) (nat %TransferToken)))
            (or (or (nat %UpdateCollateral) (nat %UpdateInterestRate))
                (or (nat %WithdrawCollateral) (option %delegate key_hash))))) ;
  storage
    (pair (pair (pair (bool %Closed) (timestamp %Insurance) (bool %Liquidated))
                (timestamp %duration)
                (nat %interest)
                (nat %interestRate))
          (pair (address %oracle) (address %owner) (address %securityDelegator))
          (pair (address %stablecoin) (nat %token))
          (address %validator)
          (nat %xtz)) ;
  code { UNPAIR ;
         IF_LEFT
           { IF_LEFT
               { IF_LEFT
                   { DROP ;
                     DUP ;
                     CAR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     NOW ;
                     SWAP ;
                     COMPARE ;
                     GE ;
                     IF {}
                        { PUSH string "WrongCondition: self.data.Insurance >= sp.now" ; FAILWITH } ;
                     DUP ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF { PUSH bool True }
                        { DUP ; CDR ; CAR ; CDR ; CDR ; SENDER ; COMPARE ; EQ } ;
                     IF { UNPAIR ;
                          UNPAIR ;
                          UNPAIR ;
                          SWAP ;
                          CDR ;
                          NOW ;
                          PAIR ;
                          SWAP ;
                          PAIR ;
                          PAIR ;
                          PAIR ;
                          DUP ;
                          GET 7 ;
                          CONTRACT %SecuritiesExercise address ;
                          IF_NONE { PUSH int 262 ; FAILWITH } {} ;
                          NIL operation ;
                          SWAP ;
                          PUSH mutez 0 ;
                          DUP 4 ;
                          CDR ;
                          CAR ;
                          CDR ;
                          CAR ;
                          TRANSFER_TOKENS ;
                          CONS }
                        { NIL operation } }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CAR ;
                         IF { PUSH string "WrongCondition: ~ self.data.Closed" ; FAILWITH } {} ;
                         AMOUNT ;
                         PUSH mutez 1 ;
                         DUP 3 ;
                         MUL ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.mutez(params.amount) == sp.amount" ;
                              FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DIG 5 ;
                         ADD ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         DUP ;
                         CAR ;
                         CDR ;
                         CAR ;
                         NOW ;
                         SUB ;
                         ABS ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH nat 315360000000 ;
                         DUP 8 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CDR ;
                         DIG 7 ;
                         DIG 8 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         MUL ;
                         MUL ;
                         EDIV ;
                         IF_NONE { PUSH int 25 ; FAILWITH } { CAR } ;
                         ADD ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         NIL operation }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CAR ;
                         IF { PUSH string "WrongCondition: ~ self.data.Closed" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CDR ;
                         CAR ;
                         NOW ;
                         SUB ;
                         ABS ;
                         DUP 3 ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH nat 315360000000 ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CDR ;
                         DIG 7 ;
                         DIG 9 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         MUL ;
                         MUL ;
                         EDIV ;
                         IF_NONE { PUSH int 70 ; FAILWITH } { CAR } ;
                         ADD ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         DIG 2 ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         DUP 7 ;
                         ADD ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         DUG 2 ;
                         NIL operation ;
                         DUP 4 ;
                         CDR ;
                         CAR ;
                         CAR ;
                         CONTRACT %MintToken
                           (pair (pair (nat %collateral) (nat %loan))
                                 (pair (address %owner) (pair (nat %token) (address %validator)))) ;
                         IF_NONE { PUSH int 79 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DIG 5 ;
                         DUP ;
                         GET 7 ;
                         SWAP ;
                         DUP ;
                         DUG 7 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CAR ;
                         DIG 5 ;
                         ADD ;
                         PAIR %token %validator ;
                         DUP 6 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         PAIR %owner ;
                         DIG 4 ;
                         DUP 6 ;
                         GET 8 ;
                         PAIR %collateral %loan ;
                         PAIR ;
                         TRANSFER_TOKENS ;
                         CONS } } }
               { IF_LEFT
                   { DROP ;
                     DUP ;
                     CAR ;
                     CAR ;
                     CDR ;
                     CDR ;
                     IF {} { PUSH string "WrongCondition: self.data.Liquidated" ; FAILWITH } ;
                     DUP ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {}
                        { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                     DUP ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     CONTRACT unit ;
                     IF_NONE { PUSH int 189 ; FAILWITH } {} ;
                     NIL operation ;
                     SWAP ;
                     BALANCE ;
                     UNIT ;
                     TRANSFER_TOKENS ;
                     CONS ;
                     SWAP ;
                     UNPAIR ;
                     UNPAIR ;
                     UNPAIR ;
                     SWAP ;
                     CAR ;
                     PUSH bool False ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     GET 7 ;
                     CONTRACT %UpdateLiquidateOwner address ;
                     IF_NONE { PUSH int 193 ; FAILWITH } {} ;
                     PUSH mutez 0 ;
                     DUP 4 ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     TRANSFER_TOKENS ;
                     CONS }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                         AMOUNT ;
                         PUSH mutez 1 ;
                         DUP 3 ;
                         CAR ;
                         MUL ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.mutez(params.amount) == sp.amount" ;
                              FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CAR ;
                         IF {} { PUSH string "WrongCondition: self.data.Closed" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CDR ;
                         CDR ;
                         IF { PUSH string "WrongCondition: ~ self.data.Liquidated" ; FAILWITH } {} ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         DUP 6 ;
                         CAR ;
                         ADD ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         DUP 6 ;
                         CDR ;
                         ADD ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         CDR ;
                         PUSH bool False ;
                         PAIR ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         NIL operation ;
                         DUP 3 ;
                         CDR ;
                         CAR ;
                         CAR ;
                         CONTRACT %MintToken
                           (pair (pair (nat %collateral) (nat %loan))
                                 (pair (address %owner) (pair (nat %token) (address %validator)))) ;
                         IF_NONE { PUSH int 44 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DUP 5 ;
                         GET 7 ;
                         PUSH nat 0 ;
                         PAIR %token %validator ;
                         DUP 6 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         PAIR %owner ;
                         DIG 4 ;
                         CDR ;
                         DUP 6 ;
                         GET 8 ;
                         PAIR %collateral %loan ;
                         PAIR ;
                         TRANSFER_TOKENS ;
                         CONS ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 7 ;
                         CONTRACT %GetInterestRate address ;
                         IF_NONE { PUSH int 48 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DUP 4 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         TRANSFER_TOKENS ;
                         CONS }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.oracle" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CDR ;
                         CAR ;
                         NOW ;
                         SUB ;
                         ABS ;
                         DUP 3 ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH nat 315360000000 ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CDR ;
                         DIG 7 ;
                         DIG 9 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         MUL ;
                         MUL ;
                         EDIV ;
                         IF_NONE { PUSH int 152 ; FAILWITH } { CAR } ;
                         ADD ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         DUP ;
                         GET 5 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 6 ;
                         DIG 3 ;
                         DUP ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CAR ;
                         SWAP ;
                         DUP ;
                         DUG 5 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         ADD ;
                         ADD ;
                         MUL ;
                         PUSH nat 1000000000000 ;
                         DUP 3 ;
                         GET 3 ;
                         DUP 5 ;
                         GET 8 ;
                         MUL ;
                         MUL ;
                         COMPARE ;
                         LT ;
                         IF { SWAP ; DUP ; DUG 2 ; CAR ; CAR ; CDR ; CAR ; NOW ; COMPARE ; GT }
                            { PUSH bool False } ;
                         IF { DUP ;
                              CAR ;
                              CDR ;
                              DUP 3 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CDR ;
                              EDIV ;
                              IF_NONE { PUSH int 158 ; FAILWITH } { CAR } ;
                              NIL operation ;
                              DUP 4 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from_) (pair (address %to_) (nat %value))) ;
                              IF_NONE { PUSH int 161 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DUP 4 ;
                              DUP 6 ;
                              GET 6 ;
                              DIG 7 ;
                              DUP ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 9 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CDR ;
                              ADD ;
                              ADD ;
                              ADD ;
                              SELF_ADDRESS ;
                              PAIR %to_ %value ;
                              DUP 6 ;
                              CAR ;
                              CAR ;
                              PAIR %from_ ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DUP 4 ;
                              GET 7 ;
                              CONTRACT %burn (pair (address %address) (pair (address %owner) (nat %value))) ;
                              IF_NONE { PUSH int 166 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DIG 5 ;
                              DUP ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 7 ;
                              CDR ;
                              CAR ;
                              CDR ;
                              CAR ;
                              PAIR %owner %value ;
                              SELF_ADDRESS ;
                              PAIR %address ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DUP 4 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from_) (pair (address %to_) (nat %value))) ;
                              IF_NONE { PUSH int 171 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DIG 3 ;
                              DUP 5 ;
                              GET 6 ;
                              DUP 7 ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              ADD ;
                              ADD ;
                              DUP 6 ;
                              GET 7 ;
                              PAIR %to_ %value ;
                              SELF_ADDRESS ;
                              PAIR %from_ ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DIG 2 ;
                              UNPAIR ;
                              UNPAIR ;
                              CDR ;
                              PUSH bool True ;
                              PAIR ;
                              PAIR ;
                              PAIR ;
                              UNPAIR ;
                              UNPAIR ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              PUSH bool True ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              PAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              PUSH nat 0 ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              CAR ;
                              PUSH nat 0 ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              UNPAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CDR ;
                              PUSH nat 0 ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              UNPAIR ;
                              SWAP ;
                              CDR ;
                              DUP 6 ;
                              CAR ;
                              CAR ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              CAR ;
                              CAR ;
                              CONTRACT unit ;
                              IF_NONE { PUSH int 182 ; FAILWITH } {} ;
                              BALANCE ;
                              UNIT ;
                              TRANSFER_TOKENS ;
                              CONS }
                            { DROP ; NIL operation } } } } }
           { IF_LEFT
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {}
                        { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                     DUP ;
                     CAR ;
                     PUSH (set nat) { 1 ; 2 ; 3 } ;
                     SWAP ;
                     MEM ;
                     IF {}
                        { PUSH string "WrongCondition: sp.set([1, 2, 3]).contains(params.duration)" ;
                          FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     CAR ;
                     CAR ;
                     IF { PUSH string "WrongCondition: ~ self.data.Closed" ; FAILWITH } {} ;
                     SWAP ;
                     UNPAIR ;
                     UNPAIR ;
                     UNPAIR ;
                     SWAP ;
                     CDR ;
                     NOW ;
                     PUSH int 60 ;
                     DUP ;
                     PUSH int 24 ;
                     PUSH nat 7 ;
                     DUP 10 ;
                     CAR ;
                     MUL ;
                     INT ;
                     MUL ;
                     MUL ;
                     MUL ;
                     ADD ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     PAIR ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     UNPAIR ;
                     SWAP ;
                     CAR ;
                     DUP 5 ;
                     GET 4 ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     CDR ;
                     CAR ;
                     NOW ;
                     SUB ;
                     ABS ;
                     DUP 3 ;
                     UNPAIR ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     PUSH nat 315360000000 ;
                     DUP 9 ;
                     CAR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     DIG 7 ;
                     DIG 9 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     CDR ;
                     MUL ;
                     MUL ;
                     EDIV ;
                     IF_NONE { PUSH int 238 ; FAILWITH } { CAR } ;
                     ADD ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     UNPAIR ;
                     UNPAIR ;
                     SWAP ;
                     CDR ;
                     NOW ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     PAIR ;
                     SWAP ;
                     NOW ;
                     NOW ;
                     PUSH int 60 ;
                     DUP ;
                     PUSH int 24 ;
                     DUP 6 ;
                     CAR ;
                     INT ;
                     MUL ;
                     MUL ;
                     MUL ;
                     ADD ;
                     SUB ;
                     ABS ;
                     DUP 3 ;
                     CAR ;
                     CDR ;
                     CDR ;
                     CDR ;
                     SWAP ;
                     DUP 4 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     CDR ;
                     MUL ;
                     MUL ;
                     PUSH nat 315360000000 ;
                     SWAP ;
                     EDIV ;
                     IF_NONE { PUSH int 245 ; FAILWITH } { CAR } ;
                     NIL operation ;
                     DUP 4 ;
                     GET 7 ;
                     CONTRACT %SecuritiesPurchase
                       (pair (pair (nat %duration) (nat %order))
                             (pair (address %spender) (pair (nat %token) (nat %xtz)))) ;
                     IF_NONE { PUSH int 247 ; FAILWITH } {} ;
                     PUSH mutez 0 ;
                     DUP 6 ;
                     GET 8 ;
                     DIG 4 ;
                     DIG 6 ;
                     DUP ;
                     CAR ;
                     CDR ;
                     CDR ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 8 ;
                     CDR ;
                     CDR ;
                     CAR ;
                     CDR ;
                     ADD ;
                     ADD ;
                     PAIR %token %xtz ;
                     DUP 6 ;
                     CDR ;
                     CAR ;
                     CDR ;
                     CAR ;
                     PAIR %spender ;
                     DIG 4 ;
                     DUP ;
                     GET 3 ;
                     SWAP ;
                     CAR ;
                     PAIR %duration %order ;
                     PAIR ;
                     TRANSFER_TOKENS ;
                     CONS }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CAR ;
                         IF { PUSH string "WrongCondition: ~ self.data.Closed" ; FAILWITH } {} ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CDR ;
                         CAR ;
                         NOW ;
                         SUB ;
                         ABS ;
                         DUP 3 ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH nat 315360000000 ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CDR ;
                         DUP 8 ;
                         DIG 10 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         MUL ;
                         MUL ;
                         EDIV ;
                         IF_NONE { PUSH int 91 ; FAILWITH } { CAR } ;
                         ADD ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         DUG 2 ;
                         PUSH nat 1 ;
                         DUP 3 ;
                         CAR ;
                         COMPARE ;
                         EQ ;
                         IF { DIG 2 ;
                              DUP ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 4 ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              ADD ;
                              DUP 3 ;
                              CDR ;
                              COMPARE ;
                              GT ;
                              IF { DIG 2 ;
                                   DUP ;
                                   CDR ;
                                   CDR ;
                                   CAR ;
                                   CDR ;
                                   SWAP ;
                                   DUP ;
                                   DUG 4 ;
                                   CAR ;
                                   CDR ;
                                   CDR ;
                                   CAR ;
                                   ADD }
                                 { SWAP ; DUP ; DUG 2 ; CDR } ;
                              NIL operation ;
                              DUP 5 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from_) (pair (address %to_) (nat %value))) ;
                              IF_NONE { PUSH int 103 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DUP 4 ;
                              SELF_ADDRESS ;
                              PAIR %to_ %value ;
                              SENDER ;
                              PAIR %from_ ;
                              TRANSFER_TOKENS ;
                              CONS }
                            { SWAP ; DUP ; DUG 2 ; CDR ; NIL operation } ;
                         PUSH nat 0 ;
                         DUP 6 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CAR ;
                         DUP 4 ;
                         COMPARE ;
                         GT ;
                         IF { DUP 6 ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              DUP 4 ;
                              SUB ;
                              ABS ;
                              DUP 7 ;
                              CDR ;
                              CDR ;
                              CAR ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              COMPARE ;
                              GE ;
                              IF { DROP 2 ;
                                   SWAP ;
                                   DROP ;
                                   SWAP ;
                                   DROP ;
                                   SWAP ;
                                   DROP ;
                                   SWAP ;
                                   DUP ;
                                   DUG 2 ;
                                   CDR ;
                                   CDR ;
                                   CAR ;
                                   CDR ;
                                   SWAP ;
                                   DUP 3 ;
                                   CDR ;
                                   CAR ;
                                   CDR ;
                                   CAR ;
                                   CONTRACT unit ;
                                   IF_NONE { PUSH int 120 ; FAILWITH } {} ;
                                   BALANCE ;
                                   UNIT ;
                                   TRANSFER_TOKENS ;
                                   CONS ;
                                   SWAP ;
                                   DIG 2 ;
                                   UNPAIR ;
                                   UNPAIR ;
                                   CDR ;
                                   PUSH bool True ;
                                   PAIR ;
                                   PAIR ;
                                   PAIR ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   SWAP ;
                                   CAR ;
                                   PUSH nat 0 ;
                                   SWAP ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   CAR ;
                                   PUSH nat 0 ;
                                   SWAP ;
                                   PAIR ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   DUG 2 }
                                 { SWAP ;
                                   DROP ;
                                   DIG 2 ;
                                   DROP ;
                                   DIG 2 ;
                                   DROP ;
                                   DIG 2 ;
                                   DROP ;
                                   DUP ;
                                   DUP 4 ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   SWAP ;
                                   UNPAIR ;
                                   CAR ;
                                   DIG 5 ;
                                   DIG 7 ;
                                   CDR ;
                                   CDR ;
                                   CAR ;
                                   CDR ;
                                   SUB ;
                                   ABS ;
                                   SWAP ;
                                   PAIR ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   SWAP ;
                                   PAIR ;
                                   DUG 2 } ;
                              DUP 3 ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              SWAP ;
                              DIG 3 ;
                              UNPAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CDR ;
                              PUSH nat 0 ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 3 ;
                              DIG 2 ;
                              DUP 4 ;
                              GET 7 ;
                              CONTRACT %burn (pair (address %address) (pair (address %owner) (nat %value))) ;
                              IF_NONE { PUSH int 131 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DIG 3 ;
                              DUP 6 ;
                              CDR ;
                              CAR ;
                              CDR ;
                              CAR ;
                              PAIR %owner %value ;
                              SELF_ADDRESS ;
                              PAIR %address ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              SWAP }
                            { DROP ;
                              DIG 2 ;
                              DROP ;
                              DIG 2 ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP 4 ;
                              UNPAIR ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CDR ;
                              DIG 6 ;
                              DIG 7 ;
                              CAR ;
                              CDR ;
                              CDR ;
                              CAR ;
                              SUB ;
                              ABS ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 } ;
                         SWAP ;
                         DUP 3 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CAR ;
                         CONTRACT %transfer (pair (address %from_) (pair (address %to_) (nat %value))) ;
                         IF_NONE { PUSH int 139 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DIG 3 ;
                         DUP 5 ;
                         GET 7 ;
                         PAIR %to_ %value ;
                         SELF_ADDRESS ;
                         PAIR %from_ ;
                         TRANSFER_TOKENS ;
                         CONS }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CAR ;
                         CAR ;
                         IF {} { PUSH string "WrongCondition: self.data.Closed" ; FAILWITH } ;
                         NIL operation ;
                         DUP 3 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CAR ;
                         CONTRACT %transfer (pair (address %from_) (pair (address %to_) (nat %value))) ;
                         IF_NONE { PUSH int 218 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DIG 3 ;
                         DUP 5 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         PAIR %to_ %value ;
                         SELF_ADDRESS ;
                         PAIR %from_ ;
                         TRANSFER_TOKENS ;
                         CONS } } }
               { IF_LEFT
                   { IF_LEFT
                       { DUP ;
                         PUSH mutez 1 ;
                         MUL ;
                         BALANCE ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.balance == sp.mutez(params.amount)" ;
                              FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CAR ;
                         DIG 4 ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 7 ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.validator" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CAR ;
                         DIG 4 ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR } ;
                     NIL operation }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                         DUP ;
                         DUP 3 ;
                         GET 8 ;
                         COMPARE ;
                         GT ;
                         IF {}
                            { PUSH string "WrongCondition: self.data.xtz > params.amount" ; FAILWITH } ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         CDR ;
                         CAR ;
                         NOW ;
                         SUB ;
                         ABS ;
                         DUP 3 ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         PUSH nat 31536000000000 ;
                         DUP 9 ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CDR ;
                         DIG 7 ;
                         DIG 9 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         MUL ;
                         MUL ;
                         EDIV ;
                         IF_NONE { PUSH int 277 ; FAILWITH } { CAR } ;
                         ADD ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         NOW ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         DUP ;
                         DUG 2 ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         CAR ;
                         DUP 5 ;
                         DIG 6 ;
                         GET 8 ;
                         SUB ;
                         ABS ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         NIL operation ;
                         DUP 3 ;
                         CDR ;
                         CAR ;
                         CAR ;
                         CONTRACT %WithdrawCollateral (pair (nat %collateral) (nat %token)) ;
                         IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                         PUSH mutez 0 ;
                         DIG 4 ;
                         DUP ;
                         CAR ;
                         CDR ;
                         CDR ;
                         CAR ;
                         SWAP ;
                         DUP ;
                         DUG 6 ;
                         CDR ;
                         CDR ;
                         CAR ;
                         CDR ;
                         ADD ;
                         DUP 6 ;
                         GET 8 ;
                         PAIR %collateral %token ;
                         TRANSFER_TOKENS ;
                         CONS ;
                         DUP 3 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         CONTRACT unit ;
                         IF_NONE { PUSH int 288 ; FAILWITH } {} ;
                         PUSH mutez 1 ;
                         DIG 3 ;
                         MUL ;
                         UNIT ;
                         TRANSFER_TOKENS ;
                         CONS }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CDR ;
                         CAR ;
                         CDR ;
                         CAR ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {}
                            { PUSH string "WrongCondition: sp.sender == self.data.owner" ; FAILWITH } ;
                         SET_DELEGATE ;
                         NIL operation ;
                         SWAP ;
                         CONS } } } } ;
         NIL operation ;
         SWAP ;
         ITER { CONS } ;
         PAIR } }
