{ parameter (ticket nat) ;
  storage
    (pair (big_map %tacos bytes address)
          (pair (address %ticketer_address) (timestamp %base_timestamp))) ;
  code { PUSH mutez 0 ;
         AMOUNT ;
         COMPARE ;
         EQ ;
         IF {} { PUSH string "failed assertion" ; FAILWITH } ;
         UNPAIR ;
         SWAP ;
         UNPAIR ;
         SWAP ;
         UNPAIR ;
         DIG 3 ;
         READ_TICKET ;
         SWAP ;
         DROP ;
         UNPAIR ;
         SWAP ;
         UNPAIR ;
         DROP ;
         DIG 2 ;
         DUP ;
         DUG 3 ;
         DIG 2 ;
         COMPARE ;
         EQ ;
         IF {} { PUSH string "failed assertion" ; FAILWITH } ;
         PUSH nat 1 ;
         SWAP ;
         COMPARE ;
         EQ ;
         IF {} { PUSH string "failed assertion" ; FAILWITH } ;
         SWAP ;
         DUP ;
         DUG 2 ;
         NOW ;
         SUB ;
         DIG 3 ;
         SOURCE ;
         SOME ;
         DIG 2 ;
         PACK ;
         SHA256 ;
         GET_AND_UPDATE ;
         DROP ;
         DUG 2 ;
         PAIR ;
         SWAP ;
         PAIR ;
         NIL operation ;
         PAIR } }
