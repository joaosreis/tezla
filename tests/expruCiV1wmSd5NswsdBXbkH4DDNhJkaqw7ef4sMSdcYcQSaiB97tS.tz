{ storage
    (pair (big_map %entrypoints string (option (lambda (pair (int %x) (int %y)) int)))
          (int %value)) ;
  parameter
    (or (or (int %add) (pair %callEP (string %entrypointName) (int %y)))
        (or (int %multiply) (or (unit %setEntrypoints) (int %square)))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { IF_LEFT
               { { PUSH int 0 ;
                   DIG 2 ;
                   DUP ;
                   DUG 3 ;
                   CDR ;
                   COMPARE ;
                   GE ;
                   IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                   DUP ;
                   PUSH int 0 ;
                   SWAP ;
                   COMPARE ;
                   GE ;
                   IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CAR ;
                   SWAP ;
                   DIG 2 ;
                   CDR ;
                   ADD ;
                   SWAP ;
                   PAIR } }
               { { SWAP ;
                   DUP ;
                   DUG 2 ;
                   CAR ;
                   DIG 2 ;
                   DUP ;
                   DUG 3 ;
                   CAR ;
                   DIG 2 ;
                   DUP ;
                   DUG 3 ;
                   CAR ;
                   GET ;
                   IF_NONE { { PUSH string "Get-item:47" ; FAILWITH } } {} ;
                   IF_NONE { { PUSH unit Unit ; FAILWITH } } { {} } ;
                   DIG 2 ;
                   CDR ;
                   DIG 3 ;
                   CDR ;
                   PAIR %x %y ;
                   EXEC ;
                   SWAP ;
                   PAIR } } }
           { IF_LEFT
               { { PUSH int 0 ;
                   DIG 2 ;
                   DUP ;
                   DUG 3 ;
                   CDR ;
                   COMPARE ;
                   GE ;
                   IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                   DUP ;
                   PUSH int 0 ;
                   SWAP ;
                   COMPARE ;
                   GE ;
                   IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CAR ;
                   SWAP ;
                   DIG 2 ;
                   CDR ;
                   MUL ;
                   SWAP ;
                   PAIR } }
               { IF_LEFT
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       LAMBDA
                         (pair (int %x) (int %y))
                         int
                         { { DUP ;
                             CAR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             SWAP ;
                             CAR ;
                             ADD } } ;
                       DIG 4 ;
                       DROP ;
                       SOME ;
                       SOME ;
                       PUSH string "add" ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       LAMBDA
                         (pair (int %x) (int %y))
                         int
                         { { DUP ;
                             CAR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             SWAP ;
                             CAR ;
                             MUL } } ;
                       DIG 4 ;
                       DROP ;
                       SOME ;
                       SOME ;
                       PUSH string "multiply" ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       LAMBDA
                         (pair (int %x) (int %y))
                         int
                         { { DUP ;
                             CAR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             PUSH int 0 ;
                             SWAP ;
                             COMPARE ;
                             GE ;
                             IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                             DUP ;
                             CDR ;
                             SWAP ;
                             DUP ;
                             DUG 2 ;
                             CAR ;
                             MUL ;
                             SWAP ;
                             DUP ;
                             DUG 2 ;
                             CDR ;
                             DIG 2 ;
                             CAR ;
                             MUL ;
                             MUL } } ;
                       DIG 4 ;
                       DROP ;
                       DIG 3 ;
                       DROP ;
                       SOME ;
                       SOME ;
                       PUSH string "square" ;
                       UPDATE ;
                       PAIR } }
                   { { PUSH int 0 ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       COMPARE ;
                       GE ;
                       IF { {} } { { PUSH string "x must be greater than 0" ; FAILWITH } } ;
                       DUP ;
                       PUSH int 0 ;
                       SWAP ;
                       COMPARE ;
                       GE ;
                       IF { {} } { { PUSH string "y must be greater than 0" ; FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       CDR ;
                       MUL ;
                       DIG 2 ;
                       DIG 3 ;
                       CDR ;
                       MUL ;
                       MUL ;
                       SWAP ;
                       PAIR } } } } ;
         NIL operation ;
         PAIR } }
