{ storage
    (pair (pair (bool %active) (pair (address %admin) (nat %commission)))
          (pair (pair (big_map %pairs
                         string
                         (map string (pair (address %contract) (pair (string %counterAsset) (nat %decimals)))))
                      (nat %swapFee))
                (pair (big_map %swaps
                         bytes
                         (pair (pair (pair (string %asset) (nat %commission))
                                     (pair (nat %expected) (address %initiator)))
                               (pair (pair (string %pair) (timestamp %refundTimestamp))
                                     (pair (bytes %swapHash) (nat %value)))))
                      (nat %userXTZDeposit)))) ;
  parameter
    (or (or (or (map %addSwapPair
                   string
                   (map string (pair (address %contract) (pair (string %counterAsset) (nat %decimals)))))
                (unit %default))
            (or (pair %offer
                   (pair (string %_asset) (pair (nat %_expected) (string %_pair)))
                   (pair (timestamp %_refundTimestamp) (pair (bytes %_swapHash) (nat %_value))))
                (or (bytes %refund) (list %removeSwapPair string))))
        (or (or (option %setBaker key_hash)
                (or (pair %take
                       (pair (string %_asset) (string %_pair))
                       (pair (bytes %_swapHash) (nat %_value)))
                    (bool %toggleContractState)))
            (or (address %transferFees)
                (or (address %updateAdmin) (pair %updateSwapFees (nat %_commission) (nat %_swapFee)))))) ;
  code { UNPAIR ;
         IF_LEFT
           { IF_LEFT
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET 3 ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                     DUP ;
                     ITER { CAR ;
                            DIG 2 ;
                            UNPAIR ;
                            SWAP ;
                            UNPAIR ;
                            UNPAIR ;
                            DUP 6 ;
                            DUP 6 ;
                            GET ;
                            IF_NONE { PUSH int 153 ; FAILWITH } {} ;
                            SOME ;
                            DIG 5 ;
                            UPDATE ;
                            PAIR ;
                            PAIR ;
                            SWAP ;
                            PAIR ;
                            SWAP } ;
                     DROP }
                   { DROP } ;
                 NIL operation }
               { IF_LEFT
                   { PUSH bool True ;
                     DUP 3 ;
                     CAR ;
                     CAR ;
                     COMPARE ;
                     EQ ;
                     IF {} { PUSH string "CONTRACT_INACTIVE" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 5 ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 5 ;
                     MEM ;
                     IF { PUSH string "HASH_ALREADY_EXISTS" ; FAILWITH } {} ;
                     DUP ;
                     GET 3 ;
                     NOW ;
                     COMPARE ;
                     LT ;
                     IF {} { PUSH string "REFUND_TIME_ALREADY_ARRIVED" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 3 ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET 4 ;
                     MEM ;
                     IF {} { PUSH string "INVALID_PAIR" ; FAILWITH } ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     GET 3 ;
                     CAR ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET 4 ;
                     GET ;
                     IF_NONE { PUSH int 79 ; FAILWITH } {} ;
                     SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     CAR ;
                     MEM ;
                     IF {} { PUSH string "INVALID_ASSET" ; FAILWITH } ;
                     DUP ;
                     CAR ;
                     CAR ;
                     PUSH string "xtz" ;
                     COMPARE ;
                     EQ ;
                     IF { PUSH mutez 1 ;
                          DUP 3 ;
                          CAR ;
                          GET 4 ;
                          DUP 3 ;
                          GET 6 ;
                          ADD ;
                          MUL ;
                          AMOUNT ;
                          COMPARE ;
                          EQ ;
                          IF {} { PUSH string "AMOUNT_MISMATCH" ; FAILWITH } ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          UNPAIR ;
                          SWAP ;
                          UNPAIR ;
                          SWAP ;
                          UNPAIR ;
                          SWAP ;
                          DIG 5 ;
                          CAR ;
                          GET 4 ;
                          DUP 6 ;
                          GET 6 ;
                          ADD ;
                          ADD ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          NIL operation }
                        { PUSH mutez 1 ;
                          DUP 3 ;
                          CAR ;
                          GET 4 ;
                          MUL ;
                          AMOUNT ;
                          COMPARE ;
                          EQ ;
                          IF {} { PUSH string "AMOUNT_MISMATCH" ; FAILWITH } ;
                          SWAP ;
                          DUP ;
                          DUG 2 ;
                          UNPAIR ;
                          SWAP ;
                          UNPAIR ;
                          SWAP ;
                          UNPAIR ;
                          SWAP ;
                          DIG 5 ;
                          CAR ;
                          GET 4 ;
                          ADD ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          PAIR ;
                          SWAP ;
                          NIL operation ;
                          DUP 3 ;
                          GET 3 ;
                          CAR ;
                          DUP 3 ;
                          CAR ;
                          GET 4 ;
                          GET ;
                          IF_NONE { PUSH int 227 ; FAILWITH } {} ;
                          DUP 3 ;
                          CAR ;
                          CAR ;
                          GET ;
                          IF_NONE { PUSH int 227 ; FAILWITH } {} ;
                          CAR ;
                          CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                          IF_NONE { PUSH int 227 ; FAILWITH } {} ;
                          PUSH mutez 0 ;
                          DUP 4 ;
                          GET 6 ;
                          SELF_ADDRESS ;
                          PAIR %to %value ;
                          SENDER ;
                          PAIR %from ;
                          TRANSFER_TOKENS ;
                          CONS } ;
                     DUP 3 ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     SWAP ;
                     UNPAIR ;
                     DIG 5 ;
                     DUP ;
                     GET 6 ;
                     SWAP ;
                     DUP ;
                     DUG 7 ;
                     GET 5 ;
                     PAIR %swapHash %value ;
                     DIG 6 ;
                     DUP ;
                     GET 3 ;
                     SWAP ;
                     DUP ;
                     DUG 8 ;
                     CAR ;
                     GET 4 ;
                     PAIR %pair %refundTimestamp ;
                     PAIR ;
                     SENDER ;
                     DUP 8 ;
                     CAR ;
                     GET 3 ;
                     PAIR %expected %initiator ;
                     DIG 8 ;
                     CAR ;
                     GET 4 ;
                     DUP 9 ;
                     CAR ;
                     CAR ;
                     PAIR %asset %commission ;
                     PAIR ;
                     PAIR ;
                     SOME ;
                     DIG 6 ;
                     GET 5 ;
                     UPDATE ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     SWAP ;
                     PAIR ;
                     SWAP }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         GET 5 ;
                         SWAP ;
                         DUP ;
                         DUG 2 ;
                         MEM ;
                         IF {} { PUSH string "INVALID_HASH" ; FAILWITH } ;
                         NOW ;
                         DUP 3 ;
                         GET 5 ;
                         DUP 3 ;
                         GET ;
                         IF_NONE { PUSH int 105 ; FAILWITH } {} ;
                         GET 3 ;
                         CDR ;
                         COMPARE ;
                         LE ;
                         IF {} { PUSH string "REFUND_TIME_NOT_ARRIVED" ; FAILWITH } ;
                         PUSH string "xtz" ;
                         DUP 3 ;
                         GET 5 ;
                         DUP 3 ;
                         GET ;
                         IF_NONE { PUSH int 276 ; FAILWITH } {} ;
                         CAR ;
                         CAR ;
                         CAR ;
                         COMPARE ;
                         EQ ;
                         IF { NIL operation ;
                              DUP 3 ;
                              GET 5 ;
                              DUP 3 ;
                              GET ;
                              IF_NONE { PUSH int 277 ; FAILWITH } {} ;
                              CAR ;
                              GET 4 ;
                              CONTRACT unit ;
                              IF_NONE { PUSH int 277 ; FAILWITH } {} ;
                              PUSH mutez 1 ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET ;
                              IF_NONE { PUSH int 277 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET ;
                              IF_NONE { PUSH int 277 ; FAILWITH } {} ;
                              GET 6 ;
                              ADD ;
                              MUL ;
                              UNIT ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DUP 3 ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET ;
                              IF_NONE { PUSH int 278 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              DUP 7 ;
                              GET 5 ;
                              DUP 7 ;
                              GET ;
                              IF_NONE { PUSH int 278 ; FAILWITH } {} ;
                              GET 6 ;
                              ADD ;
                              DIG 6 ;
                              GET 6 ;
                              SUB ;
                              ISNAT ;
                              IF_NONE { PUSH int 278 ; FAILWITH } {} ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 }
                            { SWAP ;
                              DUP ;
                              DUG 2 ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET ;
                              IF_NONE { PUSH int 280 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              DIG 5 ;
                              GET 6 ;
                              SUB ;
                              ISNAT ;
                              IF_NONE { PUSH int 280 ; FAILWITH } {} ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              NIL operation ;
                              DUP 3 ;
                              GET 5 ;
                              DUP 3 ;
                              GET ;
                              IF_NONE { PUSH int 281 ; FAILWITH } {} ;
                              CAR ;
                              GET 4 ;
                              CONTRACT unit ;
                              IF_NONE { PUSH int 281 ; FAILWITH } {} ;
                              PUSH mutez 1 ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET ;
                              IF_NONE { PUSH int 281 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              MUL ;
                              UNIT ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DIG 2 ;
                              DUP ;
                              GET 3 ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 4 ;
                              GET 5 ;
                              DUP 4 ;
                              GET ;
                              IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                              GET 3 ;
                              CAR ;
                              GET ;
                              IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                              DUP 4 ;
                              GET 5 ;
                              DUP 4 ;
                              GET ;
                              IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CAR ;
                              GET ;
                              IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                              IF_NONE { PUSH int 282 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET ;
                              IF_NONE { PUSH int 283 ; FAILWITH } {} ;
                              GET 6 ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET ;
                              IF_NONE { PUSH int 283 ; FAILWITH } {} ;
                              CAR ;
                              GET 4 ;
                              PAIR %to %value ;
                              SELF_ADDRESS ;
                              PAIR %from ;
                              TRANSFER_TOKENS ;
                              CONS } ;
                         DIG 2 ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         NONE (pair (pair (pair (string %asset) (nat %commission))
                                          (pair (nat %expected) (address %initiator)))
                                    (pair (pair (string %pair) (timestamp %refundTimestamp))
                                          (pair (bytes %swapHash) (nat %value)))) ;
                         DIG 6 ;
                         UPDATE ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                         DUP ;
                         ITER { DIG 2 ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                UNPAIR ;
                                NONE (map string (pair (address %contract) (pair (string %counterAsset) (nat %decimals)))) ;
                                DIG 5 ;
                                UPDATE ;
                                PAIR ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                SWAP } ;
                         DROP ;
                         NIL operation } } } }
           { IF_LEFT
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET 3 ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                     SET_DELEGATE ;
                     NIL operation ;
                     SWAP ;
                     CONS }
                   { IF_LEFT
                       { PUSH bool True ;
                         DUP 3 ;
                         CAR ;
                         CAR ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "CONTRACT_INACTIVE" ; FAILWITH } ;
                         NOW ;
                         DUP 3 ;
                         GET 5 ;
                         DUP 3 ;
                         GET 3 ;
                         GET ;
                         IF_NONE { PUSH int 91 ; FAILWITH } {} ;
                         GET 3 ;
                         CDR ;
                         COMPARE ;
                         GT ;
                         IF {}
                            { PUSH string
                                   "WrongCondition: self.data.swaps[params._swapHash].refundTimestamp > sp.now" ;
                              FAILWITH } ;
                         DUP ;
                         CAR ;
                         CDR ;
                         DUP 3 ;
                         GET 5 ;
                         DUP 3 ;
                         GET 3 ;
                         GET ;
                         IF_NONE { PUSH int 92 ; FAILWITH } {} ;
                         GET 3 ;
                         CAR ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "INVALID_PAIR" ; FAILWITH } ;
                         DUP ;
                         CAR ;
                         CAR ;
                         DUP 3 ;
                         GET 3 ;
                         CAR ;
                         DUP 3 ;
                         CAR ;
                         CDR ;
                         GET ;
                         IF_NONE { PUSH int 93 ; FAILWITH } {} ;
                         DUP 4 ;
                         GET 5 ;
                         DUP 4 ;
                         GET 3 ;
                         GET ;
                         IF_NONE { PUSH int 93 ; FAILWITH } {} ;
                         CAR ;
                         CAR ;
                         CAR ;
                         GET ;
                         IF_NONE { PUSH int 93 ; FAILWITH } {} ;
                         GET 3 ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "INVALID_ASSET" ; FAILWITH } ;
                         DUP ;
                         GET 4 ;
                         DUP 3 ;
                         GET 5 ;
                         DUP 3 ;
                         GET 3 ;
                         GET ;
                         IF_NONE { PUSH int 94 ; FAILWITH } {} ;
                         CAR ;
                         GET 3 ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "WRONG_AMOUNT" ; FAILWITH } ;
                         DUP ;
                         CAR ;
                         CAR ;
                         PUSH string "xtz" ;
                         COMPARE ;
                         EQ ;
                         IF { DUP ;
                              GET 4 ;
                              PUSH mutez 1 ;
                              MUL ;
                              AMOUNT ;
                              COMPARE ;
                              EQ ;
                              IF {} { PUSH string "AMOUNT_MISMATCH" ; FAILWITH } ;
                              NIL operation ;
                              DUP 3 ;
                              GET 5 ;
                              DUP 3 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 248 ; FAILWITH } {} ;
                              CAR ;
                              GET 4 ;
                              CONTRACT unit ;
                              IF_NONE { PUSH int 248 ; FAILWITH } {} ;
                              AMOUNT ;
                              UNIT ;
                              TRANSFER_TOKENS ;
                              CONS }
                            { NIL operation ;
                              DUP 3 ;
                              GET 3 ;
                              CAR ;
                              DUP 3 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { PUSH int 250 ; FAILWITH } {} ;
                              DUP 3 ;
                              CAR ;
                              CAR ;
                              GET ;
                              IF_NONE { PUSH int 250 ; FAILWITH } {} ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                              IF_NONE { PUSH int 250 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DUP 4 ;
                              GET 4 ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 251 ; FAILWITH } {} ;
                              CAR ;
                              GET 4 ;
                              PAIR %to %value ;
                              SENDER ;
                              PAIR %from ;
                              TRANSFER_TOKENS ;
                              CONS } ;
                         PUSH string "xtz" ;
                         DUP 4 ;
                         GET 5 ;
                         DUP 4 ;
                         GET 3 ;
                         GET ;
                         IF_NONE { PUSH int 254 ; FAILWITH } {} ;
                         CAR ;
                         CAR ;
                         CAR ;
                         COMPARE ;
                         EQ ;
                         IF { SENDER ;
                              CONTRACT unit ;
                              IF_NONE { PUSH int 255 ; FAILWITH } {} ;
                              PUSH mutez 1 ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 255 ; FAILWITH } {} ;
                              GET 6 ;
                              MUL ;
                              UNIT ;
                              TRANSFER_TOKENS ;
                              CONS ;
                              DUP 3 ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 256 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              DUP 7 ;
                              GET 5 ;
                              DUP 7 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 256 ; FAILWITH } {} ;
                              GET 6 ;
                              ADD ;
                              DIG 6 ;
                              GET 6 ;
                              SUB ;
                              ISNAT ;
                              IF_NONE { PUSH int 256 ; FAILWITH } {} ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 }
                            { DUP 3 ;
                              UNPAIR ;
                              SWAP ;
                              UNPAIR ;
                              SWAP ;
                              CAR ;
                              DUP 6 ;
                              GET 5 ;
                              DUP 6 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 258 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CDR ;
                              DIG 6 ;
                              GET 6 ;
                              SUB ;
                              ISNAT ;
                              IF_NONE { PUSH int 258 ; FAILWITH } {} ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUP ;
                              DUG 3 ;
                              GET 3 ;
                              CAR ;
                              DUP 3 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { PUSH int 259 ; FAILWITH } {} ;
                              DUP 4 ;
                              GET 5 ;
                              DUP 4 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 259 ; FAILWITH } {} ;
                              CAR ;
                              CAR ;
                              CAR ;
                              GET ;
                              IF_NONE { PUSH int 259 ; FAILWITH } {} ;
                              CAR ;
                              CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                              IF_NONE { PUSH int 259 ; FAILWITH } {} ;
                              PUSH mutez 0 ;
                              DUP 5 ;
                              GET 5 ;
                              DUP 5 ;
                              GET 3 ;
                              GET ;
                              IF_NONE { PUSH int 260 ; FAILWITH } {} ;
                              GET 6 ;
                              SENDER ;
                              PAIR %to %value ;
                              SELF_ADDRESS ;
                              PAIR %from ;
                              TRANSFER_TOKENS ;
                              CONS } ;
                         DIG 2 ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         SWAP ;
                         UNPAIR ;
                         NONE (pair (pair (pair (string %asset) (nat %commission))
                                          (pair (nat %expected) (address %initiator)))
                                    (pair (pair (string %pair) (timestamp %refundTimestamp))
                                          (pair (bytes %swapHash) (nat %value)))) ;
                         DIG 6 ;
                         GET 3 ;
                         UPDATE ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         CDR ;
                         DIG 2 ;
                         PAIR ;
                         PAIR ;
                         NIL operation } } }
               { IF_LEFT
                   { SWAP ;
                     DUP ;
                     DUG 2 ;
                     CAR ;
                     GET 3 ;
                     SENDER ;
                     COMPARE ;
                     EQ ;
                     IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                     PUSH mutez 0 ;
                     PUSH mutez 1 ;
                     DUP 4 ;
                     GET 6 ;
                     MUL ;
                     BALANCE ;
                     SUB ;
                     COMPARE ;
                     GT ;
                     IF {}
                        { PUSH string
                               "WrongCondition: (sp.balance - sp.mutez(self.data.userXTZDeposit)) > sp.tez(0)" ;
                          FAILWITH } ;
                     CONTRACT unit ;
                     IF_NONE { PUSH int 204 ; FAILWITH } {} ;
                     NIL operation ;
                     SWAP ;
                     PUSH mutez 1 ;
                     DUP 4 ;
                     GET 6 ;
                     MUL ;
                     BALANCE ;
                     SUB ;
                     UNIT ;
                     TRANSFER_TOKENS ;
                     CONS }
                   { IF_LEFT
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CDR ;
                         DIG 3 ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         PAIR }
                       { SWAP ;
                         DUP ;
                         DUG 2 ;
                         CAR ;
                         GET 3 ;
                         SENDER ;
                         COMPARE ;
                         EQ ;
                         IF {} { PUSH string "ONLY_ADMIN" ; FAILWITH } ;
                         SWAP ;
                         UNPAIR ;
                         UNPAIR ;
                         SWAP ;
                         CAR ;
                         DUP 4 ;
                         CAR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         PAIR ;
                         SWAP ;
                         UNPAIR ;
                         CAR ;
                         DIG 3 ;
                         CDR ;
                         SWAP ;
                         PAIR ;
                         PAIR ;
                         SWAP ;
                         PAIR } ;
                     NIL operation } } } ;
         NIL operation ;
         SWAP ;
         ITER { CONS } ;
         PAIR } }
