{ parameter unit ;
  storage unit ;
  code { DUP ;
         CAR ;
         DIG 1 ;
         DUP ;
         DUG 2 ;
         CDR ;
         SELF ;
         DIG 2 ;
         DUP ;
         DUG 3 ;
         DUP ;
         DUP ;
         DUP ;
         PUSH (lambda unit (pair (list operation) unit))
              { DUP ;
                DUP ;
                DUP ;
                PUSH nat 3 ;
                PUSH nat 2 ;
                PUSH nat 1 ;
                ADD ;
                COMPARE ;
                EQ ;
                PUSH int 1 ;
                PUSH int 3 ;
                PUSH int -2 ;
                ADD ;
                COMPARE ;
                EQ ;
                AND ;
                { IF {} { { UNIT ; FAILWITH } } } ;
                UNIT ;
                NIL operation ;
                PAIR ;
                DIP { DROP 4 } } ;
         DIP { DROP 4 } ;
         DIG 2 ;
         DUP ;
         DUG 3 ;
         EXEC ;
         DIP { DROP 4 } } }
