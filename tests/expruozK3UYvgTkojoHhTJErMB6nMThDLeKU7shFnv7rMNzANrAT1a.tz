{ storage
    (pair (pair (big_map %accessLogs string (map string (set (pair address timestamp))))
                (big_map %accessRights string (map string (set (pair address string)))))
          (pair (big_map %agreements
                   address
                   (map string
                        (pair (pair (set %data string) (address %employer))
                              (pair (timestamp %leftDate) (bool %updateRights)))))
                (pair (big_map %employers address timestamp) (address %manager)))) ;
  parameter
    (or (or (or (pair %addAgreement
                   (set %agreementHashSet string)
                   (pair (string %agreementId) (address %employeeAddr)))
                (address %addEmployer))
            (or (address %changeManager)
                (pair %employeeResign (string %agreementId) (address %employeeAddr))))
        (or (or (pair %modifyAccessRights
                   (pair (string %agreementHash) (string %agreementId))
                   (pair (bool %isAddRights) (address %userAddr)))
                (pair %modifyAgreement
                   (pair (string %agreementHash) (string %agreementId))
                   (pair (address %employeeAddr) (bool %isAddAgHash))))
            (or (pair %modifyUpdateRights (string %agreementId) (bool %updateRights))
                (or (address %removeEmployer)
                    (pair %verfiyAccessRights
                       (string %agreementHash)
                       (pair (string %agreementId) (address %employeeAddr))))))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { IF_LEFT
               { IF_LEFT
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CDR ;
                       CAR ;
                       SENDER ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.employers.contains(sp.sender)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CDR ;
                       MEM ;
                       IF { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:46" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              MEM ;
                              IF { { PUSH string
                                          "WrongCondition: ~ (self.data.agreements[params.employeeAddr].contains(params.agreementId))" ;
                                     FAILWITH } }
                                 { {} } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CDR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              PUSH (pair (timestamp %leftDate) (bool %updateRights)) (Pair "0" False) ;
                              SENDER ;
                              DIG 7 ;
                              DUP ;
                              DUG 8 ;
                              CAR ;
                              PAIR %data %employer ;
                              PAIR ;
                              SOME ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CDR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } }
                          { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              PUSH (map string
                                        (pair (pair (set %data string) (address %employer))
                                              (pair (timestamp %leftDate) (bool %updateRights))))
                                   {} ;
                              PUSH (pair (timestamp %leftDate) (bool %updateRights)) (Pair "0" False) ;
                              SENDER ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              PAIR %data %employer ;
                              PAIR ;
                              SOME ;
                              DIG 5 ;
                              DUP ;
                              DUG 6 ;
                              CDR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CDR ;
                              CDR ;
                              UPDATE ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } } ;
                       PUSH (map string (set (pair address string))) {} ;
                       PUSH (map string (set (pair address timestamp))) {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       ITER { DIG 2 ;
                              DUP ;
                              DUG 3 ;
                              PUSH (set (pair address string)) {} ;
                              PUSH bool True ;
                              PUSH string "employee" ;
                              DIG 7 ;
                              DUP ;
                              DUG 8 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              PUSH string "employer" ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 2 ;
                              DUP ;
                              DUG 3 ;
                              UPDATE ;
                              DUG 3 ;
                              DIG 2 ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              PUSH (set (pair address timestamp)) {} ;
                              PUSH bool True ;
                              NOW ;
                              DIG 7 ;
                              DUP ;
                              DUG 8 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              NOW ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 2 ;
                              DUP ;
                              DUG 3 ;
                              UPDATE ;
                              DUG 2 ;
                              DROP ;
                              DROP } ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       SOME ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CDR ;
                       CAR ;
                       UPDATE ;
                       SWAP ;
                       PAIR ;
                       PAIR ;
                       DUG 4 ;
                       DIG 3 ;
                       DROP ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       SOME ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CDR ;
                       CAR ;
                       UPDATE ;
                       PAIR ;
                       PAIR ;
                       DUG 4 ;
                       DROP ;
                       DROP ;
                       DROP ;
                       DROP } }
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CDR ;
                       CDR ;
                       SENDER ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string "WrongCondition: sp.sender == self.data.manager" ; FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       MEM ;
                       IF { { PUSH string
                                   "WrongCondition: ~ (self.data.employers.contains(params.employerAddr))" ;
                              FAILWITH } }
                          { {} } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       NOW ;
                       SOME ;
                       DIG 5 ;
                       DUP ;
                       DUG 6 ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } } }
               { IF_LEFT
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CDR ;
                       CDR ;
                       SENDER ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string "WrongCondition: sp.sender == self.data.manager" ; FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       CAR ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } }
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.agreements.contains(params.employeeAddr)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:139" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr].contains(params.agreementId)" ;
                              FAILWITH } } ;
                       SENDER ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:139" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:140" ; FAILWITH } } {} ;
                       CAR ;
                       CDR ;
                       COMPARE ;
                       EQ ;
                       IF { PUSH bool True } { { DUP ; CDR ; SENDER ; COMPARE ; EQ } } ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: (self.data.agreements[params.employeeAddr][params.agreementId].employer == sp.sender) | (params.employeeAddr == sp.sender)" ;
                              FAILWITH } } ;
                       PUSH timestamp "0" ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:139" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:140" ; FAILWITH } } {} ;
                       CDR ;
                       CAR ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].leftDate == sp.timestamp(0)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       CDR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CAR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       CDR ;
                       NOW ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       SWAP ;
                       DROP ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       CDR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CAR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       CAR ;
                       PUSH bool False ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } } } }
           { IF_LEFT
               { IF_LEFT
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.accessRights.contains(params.agreementId)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:106" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CAR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.accessRights[params.agreementId].contains(params.agreementHash)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:106" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:107" ; FAILWITH } } {} ;
                       PUSH string "employee" ;
                       SENDER ;
                       PAIR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employee'))" ;
                              FAILWITH } } ;
                       DUP ;
                       CDR ;
                       CAR ;
                       IF { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:106" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:107" ; FAILWITH } } {} ;
                              PUSH string "guest" ;
                              DIG 2 ;
                              DUP ;
                              DUG 3 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              MEM ;
                              IF { { PUSH string
                                          "WrongCondition: ~ (self.data.accessRights[params.agreementId][params.agreementHash].contains((params.userAddr, 'guest')))" ;
                                     FAILWITH } }
                                 { {} } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
                              PUSH bool True ;
                              PUSH string "guest" ;
                              DIG 9 ;
                              DUP ;
                              DUG 10 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } }
                          { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:106" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:107" ; FAILWITH } } {} ;
                              PUSH string "guest" ;
                              DIG 2 ;
                              DUP ;
                              DUG 3 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              MEM ;
                              IF { {} }
                                 { { PUSH string
                                          "WrongCondition: self.data.accessRights[params.agreementId][params.agreementHash].contains((params.userAddr, 'guest'))" ;
                                     FAILWITH } } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
                              PUSH bool False ;
                              PUSH string "guest" ;
                              DIG 9 ;
                              DUP ;
                              DUG 10 ;
                              CDR ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } } ;
                       DROP } }
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.agreements.contains(params.employeeAddr)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:77" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr].contains(params.agreementId)" ;
                              FAILWITH } } ;
                       SENDER ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:77" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:78" ; FAILWITH } } {} ;
                       CAR ;
                       CDR ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].employer == sp.sender" ;
                              FAILWITH } } ;
                       PUSH bool True ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       CAR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:77" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:78" ; FAILWITH } } {} ;
                       CDR ;
                       CDR ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].updateRights == True" ;
                              FAILWITH } } ;
                       DUP ;
                       CDR ;
                       CDR ;
                       IF { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:77" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:78" ; FAILWITH } } {} ;
                              CAR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              MEM ;
                              IF { { PUSH string
                                          "WrongCondition: ~ (self.data.agreements[params.employeeAddr][params.agreementId].data.contains(params.agreementHash))" ;
                                     FAILWITH } }
                                 { {} } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CDR ;
                              CAR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              PUSH bool True ;
                              DIG 10 ;
                              DUP ;
                              DUG 11 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              PUSH (set (pair address string)) {} ;
                              PUSH bool True ;
                              PUSH string "employee" ;
                              DIG 8 ;
                              DUP ;
                              DUG 9 ;
                              CDR ;
                              CAR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              PUSH string "employer" ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              PUSH (set (pair address timestamp)) {} ;
                              PUSH bool True ;
                              NOW ;
                              DIG 8 ;
                              DUP ;
                              DUG 9 ;
                              CDR ;
                              CAR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              NOW ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } }
                          { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              CAR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:77" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:78" ; FAILWITH } } {} ;
                              CAR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              MEM ;
                              IF { {} }
                                 { { PUSH string
                                          "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].data.contains(params.agreementHash)" ;
                                     FAILWITH } } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CDR ;
                              CAR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              PUSH bool False ;
                              DIG 10 ;
                              DUP ;
                              DUG 11 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              NONE (set (pair address string)) ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              NONE (set (pair address timestamp)) ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       DIG 4 ;
                       DUP ;
                       DUG 5 ;
                       CDR ;
                       CAR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CAR ;
                       CDR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       CAR ;
                       PUSH bool False ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } } }
               { IF_LEFT
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SENDER ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.agreements.contains(sp.sender)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       CAR ;
                       SENDER ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:-1" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[sp.sender].contains(params.agreementId)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       CDR ;
                       SWAP ;
                       CAR ;
                       DUP ;
                       SENDER ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       DIG 6 ;
                       DUP ;
                       DUG 7 ;
                       CAR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       CAR ;
                       DIG 8 ;
                       DUP ;
                       DUG 9 ;
                       CDR ;
                       SWAP ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       PAIR ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } }
                   { IF_LEFT
                       { { SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CDR ;
                           SENDER ;
                           COMPARE ;
                           EQ ;
                           IF { {} }
                              { { PUSH string "WrongCondition: sp.sender == self.data.manager" ; FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CDR ;
                           CAR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           MEM ;
                           IF { {} }
                              { { PUSH string "WrongCondition: self.data.employers.contains(params.employerAddr)" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           DUP ;
                           CAR ;
                           SWAP ;
                           CDR ;
                           DUP ;
                           CAR ;
                           SWAP ;
                           CDR ;
                           DUP ;
                           CDR ;
                           SWAP ;
                           CAR ;
                           NONE timestamp ;
                           DIG 5 ;
                           DUP ;
                           DUG 6 ;
                           UPDATE ;
                           PAIR ;
                           SWAP ;
                           PAIR ;
                           SWAP ;
                           PAIR ;
                           DUG 2 ;
                           DROP ;
                           DROP } }
                       { { SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           MEM ;
                           IF { {} }
                              { { PUSH string "WrongCondition: self.data.accessRights.contains(params.agreementId)" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           MEM ;
                           IF { {} }
                              { { PUSH string
                                       "WrongCondition: self.data.accessRights[params.agreementId].contains(params.agreementHash)" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:123" ; FAILWITH } } {} ;
                           PUSH string "guest" ;
                           SENDER ;
                           PAIR ;
                           MEM ;
                           IF { PUSH bool True }
                              { { SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CDR ;
                                  CAR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:123" ; FAILWITH } } {} ;
                                  PUSH string "employer" ;
                                  SENDER ;
                                  PAIR ;
                                  MEM } } ;
                           IF { PUSH bool True }
                              { { SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CDR ;
                                  CAR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:123" ; FAILWITH } } {} ;
                                  PUSH string "employee" ;
                                  SENDER ;
                                  PAIR ;
                                  MEM } } ;
                           IF { {} }
                              { { PUSH string
                                       "WrongCondition: ((self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'guest'))) | (self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employer')))) | (self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employee')))" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CDR ;
                           CAR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:123" ; FAILWITH } } {} ;
                           PUSH string "employer" ;
                           SENDER ;
                           PAIR ;
                           MEM ;
                           IF { { SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CDR ;
                                  CAR ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CDR ;
                                  CDR ;
                                  MEM ;
                                  IF { {} }
                                     { { PUSH string "WrongCondition: self.data.agreements.contains(params.employeeAddr)" ;
                                         FAILWITH } } ;
                                  PUSH timestamp "0" ;
                                  DIG 2 ;
                                  DUP ;
                                  DUG 3 ;
                                  CDR ;
                                  CAR ;
                                  DIG 2 ;
                                  DUP ;
                                  DUG 3 ;
                                  CDR ;
                                  CDR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:130" ; FAILWITH } } {} ;
                                  DIG 2 ;
                                  DUP ;
                                  DUG 3 ;
                                  CDR ;
                                  CAR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                                  CDR ;
                                  CAR ;
                                  COMPARE ;
                                  NEQ ;
                                  IF { { PUSH int 157680000 ;
                                         DIG 2 ;
                                         DUP ;
                                         DUG 3 ;
                                         CDR ;
                                         CAR ;
                                         DIG 2 ;
                                         DUP ;
                                         DUG 3 ;
                                         CDR ;
                                         CDR ;
                                         GET ;
                                         IF_NONE { { PUSH string "Get-item:130" ; FAILWITH } } {} ;
                                         DIG 2 ;
                                         DUP ;
                                         DUG 3 ;
                                         CDR ;
                                         CAR ;
                                         GET ;
                                         IF_NONE { { PUSH string "Get-item:122" ; FAILWITH } } {} ;
                                         CDR ;
                                         CAR ;
                                         NOW ;
                                         SUB ;
                                         COMPARE ;
                                         LT ;
                                         IF { {} }
                                            { { PUSH string
                                                     "WrongCondition: (sp.now - self.data.agreements[params.employeeAddr][params.agreementId].leftDate) < 157680000" ;
                                                FAILWITH } } } }
                                     { {} } } }
                              { {} } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           DUP ;
                           CDR ;
                           SWAP ;
                           CAR ;
                           DUP ;
                           CDR ;
                           SWAP ;
                           CAR ;
                           DUP ;
                           DIG 4 ;
                           DUP ;
                           DUG 5 ;
                           CDR ;
                           CAR ;
                           DUP ;
                           DUG 2 ;
                           GET ;
                           IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                           DUP ;
                           DIG 6 ;
                           DUP ;
                           DUG 7 ;
                           CAR ;
                           DUP ;
                           DUG 2 ;
                           GET ;
                           IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
                           PUSH bool True ;
                           NOW ;
                           SENDER ;
                           PAIR ;
                           UPDATE ;
                           SOME ;
                           SWAP ;
                           UPDATE ;
                           SOME ;
                           SWAP ;
                           UPDATE ;
                           PAIR ;
                           PAIR ;
                           DUG 2 ;
                           DROP ;
                           DROP } } } } } ;
         NIL operation ;
         PAIR } }
