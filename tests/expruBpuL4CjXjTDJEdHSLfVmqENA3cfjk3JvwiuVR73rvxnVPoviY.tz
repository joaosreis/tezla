{ storage (pair (map %ownerApprovalRegister address bool) (option %x address)) ;
  parameter unit ;
  code { CDR ;
         EMPTY_SET address ;
         SENDER ;
         PAIR %ownershipClaimer %warden ;
         PUSH timestamp "1970-01-01T00:00:00Z" ;
         PAIR %ownerShipClaimAt ;
         PUSH (pair (map %ownerApprovalRegister address bool) (bool %ownerChangeRequestExists))
              (Pair {} False) ;
         PAIR ;
         SENDER ;
         PUSH string "" ;
         PAIR %lastMessage %owner ;
         PUSH (pair (int %allVotesCount) (int %favourVotesCount)) (Pair 0 0) ;
         PAIR ;
         PAIR ;
         PUSH mutez 0 ;
         NONE key_hash ;
         CREATE_CONTRACT
           { parameter
               (or (or (or (address %addWarden)
                           (or (unit %certifyClaimAndGainAccess) (unit %claimOwnership)))
                       (or (unit %default) (or (unit %destructOwnershipClaim) (string %recievePayment))))
                   (or (or (address %removeWarden)
                           (or (pair %sendToEOA (address %to) (mutez %toPay)) (option %setDelegation key_hash)))
                       (or (unit %signOwnershipTransferAsWarden)
                           (or (pair %tokenTransfer (address %targetContract) (pair (address %to_) (nat %value)))
                               (pair %transfer (string %note) (pair (address %targetContract) (mutez %toPay))))))) ;
             storage
               (pair (pair (pair (int %allVotesCount) (int %favourVotesCount))
                           (pair (string %lastMessage) (address %owner)))
                     (pair (pair (map %ownerApprovalRegister address bool) (bool %ownerChangeRequestExists))
                           (pair (timestamp %ownerShipClaimAt)
                                 (pair (address %ownershipClaimer) (set %warden address))))) ;
             code { UNPAIR ;
                    IF_LEFT
                      { IF_LEFT
                          { IF_LEFT
                              { SWAP ;
                                DUP ;
                                DUG 2 ;
                                CAR ;
                                CDR ;
                                CDR ;
                                SENDER ;
                                COMPARE ;
                                EQ ;
                                IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                PUSH bool True ;
                                DIG 6 ;
                                UPDATE ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR }
                              { IF_LEFT
                                  { SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    GET 7 ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-Authorized" ; FAILWITH } ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    GET 5 ;
                                    PUSH int 129600 ;
                                    ADD ;
                                    NOW ;
                                    COMPARE ;
                                    GT ;
                                    IF {} { PUSH string "Cooling period not over yet. Please wait." ; FAILWITH } ;
                                    SWAP ;
                                    UNPAIR ;
                                    UNPAIR ;
                                    CDR ;
                                    PUSH int 0 ;
                                    PAIR ;
                                    PAIR ;
                                    PAIR ;
                                    UNPAIR ;
                                    UNPAIR ;
                                    CAR ;
                                    PUSH int 0 ;
                                    SWAP ;
                                    PAIR ;
                                    PAIR ;
                                    PAIR ;
                                    DUP ;
                                    DUG 2 ;
                                    CDR ;
                                    CAR ;
                                    CAR ;
                                    ITER { DIG 2 ;
                                           UNPAIR ;
                                           UNPAIR ;
                                           UNPAIR ;
                                           PUSH int 1 ;
                                           ADD ;
                                           PAIR ;
                                           PAIR ;
                                           PAIR ;
                                           DUG 2 ;
                                           CDR ;
                                           PUSH bool True ;
                                           COMPARE ;
                                           EQ ;
                                           IF { SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                SWAP ;
                                                PUSH int 1 ;
                                                ADD ;
                                                SWAP ;
                                                PAIR ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP }
                                              {} } ;
                                    SWAP ;
                                    DUP ;
                                    CAR ;
                                    CAR ;
                                    CDR ;
                                    SWAP ;
                                    DUP ;
                                    DUG 3 ;
                                    CAR ;
                                    CAR ;
                                    CAR ;
                                    COMPARE ;
                                    EQ ;
                                    IF { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         UNPAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         CAR ;
                                         DIG 4 ;
                                         GET 7 ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         CAR ;
                                         PUSH bool False ;
                                         SWAP ;
                                         PAIR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         PUSH timestamp "1970-01-01T00:00:00Z" ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         DUP ;
                                         DUG 2 ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         DIG 5 ;
                                         CAR ;
                                         CDR ;
                                         CDR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         DUP ;
                                         DUG 2 ;
                                         CDR ;
                                         CAR ;
                                         CAR ;
                                         ITER { DIG 2 ;
                                                UNPAIR ;
                                                SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                NONE bool ;
                                                DIG 5 ;
                                                CAR ;
                                                UPDATE ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP ;
                                                PAIR ;
                                                SWAP } ;
                                         DROP }
                                       { PUSH string "All Warden have not signed it." ; FAILWITH } ;
                                    UNPAIR ;
                                    UNPAIR ;
                                    CDR ;
                                    PUSH int 0 ;
                                    PAIR ;
                                    PAIR ;
                                    PAIR ;
                                    UNPAIR ;
                                    UNPAIR ;
                                    CAR ;
                                    PUSH int 0 ;
                                    SWAP ;
                                    PAIR ;
                                    PAIR ;
                                    PAIR }
                                  { PUSH nat 0 ;
                                    DUP 3 ;
                                    GET 8 ;
                                    SIZE ;
                                    COMPARE ;
                                    GT ;
                                    IF {}
                                       { PUSH string "No warden exists to sign the change of ownership." ; FAILWITH } ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    NEQ ;
                                    IF {} { PUSH string "You are already the owner." ; FAILWITH } ;
                                    PUSH bool True ;
                                    DUP 3 ;
                                    CDR ;
                                    CAR ;
                                    CDR ;
                                    COMPARE ;
                                    EQ ;
                                    IF { SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 5 ;
                                         PUSH int 129600 ;
                                         ADD ;
                                         NOW ;
                                         COMPARE ;
                                         LT ;
                                         IF {} { PUSH string "A fresh claim request already exists." ; FAILWITH } ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         CAR ;
                                         PUSH bool False ;
                                         SWAP ;
                                         PAIR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         PUSH timestamp "1970-01-01T00:00:00Z" ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         DUP ;
                                         DUG 2 ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         DIG 5 ;
                                         CAR ;
                                         CDR ;
                                         CDR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         CAR ;
                                         PUSH bool True ;
                                         SWAP ;
                                         PAIR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         SENDER ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         NOW ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         DUP ;
                                         DUG 2 ;
                                         CDR ;
                                         CAR ;
                                         CAR ;
                                         ITER { DIG 2 ;
                                                UNPAIR ;
                                                SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                NONE bool ;
                                                DIG 5 ;
                                                CAR ;
                                                UPDATE ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP ;
                                                PAIR ;
                                                SWAP } ;
                                         SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 8 ;
                                         ITER { DIG 2 ;
                                                UNPAIR ;
                                                SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                PUSH (option bool) (Some False) ;
                                                DIG 5 ;
                                                UPDATE ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP ;
                                                PAIR ;
                                                SWAP } ;
                                         DROP }
                                       { SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         CAR ;
                                         PUSH bool True ;
                                         SWAP ;
                                         PAIR ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         SENDER ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         UNPAIR ;
                                         SWAP ;
                                         UNPAIR ;
                                         SWAP ;
                                         CDR ;
                                         NOW ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         SWAP ;
                                         PAIR ;
                                         DUP ;
                                         DUG 2 ;
                                         CDR ;
                                         CAR ;
                                         CAR ;
                                         ITER { DIG 2 ;
                                                UNPAIR ;
                                                SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                NONE bool ;
                                                DIG 5 ;
                                                CAR ;
                                                UPDATE ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP ;
                                                PAIR ;
                                                SWAP } ;
                                         SWAP ;
                                         DUP ;
                                         DUG 2 ;
                                         GET 8 ;
                                         ITER { DIG 2 ;
                                                UNPAIR ;
                                                SWAP ;
                                                UNPAIR ;
                                                UNPAIR ;
                                                PUSH (option bool) (Some False) ;
                                                DIG 5 ;
                                                UPDATE ;
                                                PAIR ;
                                                PAIR ;
                                                SWAP ;
                                                PAIR ;
                                                SWAP } ;
                                         DROP } } } }
                          { IF_LEFT
                              { DROP ;
                                PUSH mutez 0 ;
                                AMOUNT ;
                                COMPARE ;
                                GE ;
                                IF {} { PUSH string "Please send atleast 1 mutez" ; FAILWITH } }
                              { IF_LEFT
                                  { SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                    PUSH bool True ;
                                    DUP 3 ;
                                    CDR ;
                                    CAR ;
                                    CDR ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Request doesn't exists" ; FAILWITH } ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    GET 5 ;
                                    PUSH int 129600 ;
                                    ADD ;
                                    NOW ;
                                    COMPARE ;
                                    LT ;
                                    IF {} { PUSH string "Sorry time elapsed." ; FAILWITH } ;
                                    SWAP ;
                                    UNPAIR ;
                                    SWAP ;
                                    UNPAIR ;
                                    CAR ;
                                    PUSH bool False ;
                                    SWAP ;
                                    PAIR ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    UNPAIR ;
                                    SWAP ;
                                    UNPAIR ;
                                    SWAP ;
                                    CDR ;
                                    PUSH timestamp "1970-01-01T00:00:00Z" ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    DUP ;
                                    DUG 2 ;
                                    UNPAIR ;
                                    SWAP ;
                                    UNPAIR ;
                                    SWAP ;
                                    UNPAIR ;
                                    SWAP ;
                                    CDR ;
                                    DIG 5 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    SWAP ;
                                    PAIR ;
                                    DUP ;
                                    DUG 2 ;
                                    CDR ;
                                    CAR ;
                                    CAR ;
                                    ITER { DIG 2 ;
                                           UNPAIR ;
                                           SWAP ;
                                           UNPAIR ;
                                           UNPAIR ;
                                           NONE bool ;
                                           DIG 5 ;
                                           CAR ;
                                           UPDATE ;
                                           PAIR ;
                                           PAIR ;
                                           SWAP ;
                                           PAIR ;
                                           SWAP } ;
                                    DROP }
                                  { SWAP ; UNPAIR ; UNPAIR ; SWAP ; CDR ; DIG 3 ; PAIR ; SWAP ; PAIR ; PAIR } } } ;
                        NIL operation }
                      { IF_LEFT
                          { IF_LEFT
                              { SWAP ;
                                DUP ;
                                DUG 2 ;
                                CAR ;
                                CDR ;
                                CDR ;
                                SENDER ;
                                COMPARE ;
                                EQ ;
                                IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                SWAP ;
                                PUSH bool False ;
                                DIG 6 ;
                                UPDATE ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                NIL operation }
                              { IF_LEFT
                                  { DUP ;
                                    CDR ;
                                    BALANCE ;
                                    COMPARE ;
                                    GE ;
                                    IF {} { PUSH string "Insufficient Balance" ; FAILWITH } ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                    DUP ;
                                    CAR ;
                                    CONTRACT unit ;
                                    IF_NONE { PUSH int 91 ; FAILWITH } {} ;
                                    NIL operation ;
                                    SWAP ;
                                    DIG 2 ;
                                    CDR ;
                                    UNIT ;
                                    TRANSFER_TOKENS ;
                                    CONS }
                                  { SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                    SET_DELEGATE ;
                                    NIL operation ;
                                    SWAP ;
                                    CONS } } }
                          { IF_LEFT
                              { DROP ;
                                DUP ;
                                CDR ;
                                CAR ;
                                CDR ;
                                PUSH bool True ;
                                COMPARE ;
                                EQ ;
                                IF {}
                                   { PUSH string "Ownership transfer requests does not exists." ; FAILWITH } ;
                                DUP ;
                                GET 8 ;
                                SENDER ;
                                MEM ;
                                IF {} { PUSH string "You are not a warden." ; FAILWITH } ;
                                UNPAIR ;
                                SWAP ;
                                UNPAIR ;
                                UNPAIR ;
                                PUSH (option bool) (Some True) ;
                                SENDER ;
                                UPDATE ;
                                PAIR ;
                                PAIR ;
                                SWAP ;
                                PAIR ;
                                NIL operation }
                              { IF_LEFT
                                  { SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                    DUP ;
                                    CAR ;
                                    CONTRACT %transfer (pair (address %from) (pair (address %to) (nat %value))) ;
                                    IF_NONE { PUSH int 58 ; FAILWITH } {} ;
                                    NIL operation ;
                                    SWAP ;
                                    PUSH mutez 0 ;
                                    DIG 3 ;
                                    DUP ;
                                    GET 4 ;
                                    SWAP ;
                                    GET 3 ;
                                    PAIR %to %value ;
                                    SELF_ADDRESS ;
                                    PAIR %from ;
                                    TRANSFER_TOKENS ;
                                    CONS }
                                  { DUP ;
                                    GET 4 ;
                                    BALANCE ;
                                    COMPARE ;
                                    GE ;
                                    IF {} { PUSH string "Insufficient Balance" ; FAILWITH } ;
                                    SWAP ;
                                    DUP ;
                                    DUG 2 ;
                                    CAR ;
                                    CDR ;
                                    CDR ;
                                    SENDER ;
                                    COMPARE ;
                                    EQ ;
                                    IF {} { PUSH string "Un-authorized" ; FAILWITH } ;
                                    DUP ;
                                    GET 3 ;
                                    CONTRACT %recievePayment string ;
                                    IF_NONE { PUSH int 10 ; FAILWITH } {} ;
                                    NIL operation ;
                                    SWAP ;
                                    DIG 2 ;
                                    DUP ;
                                    GET 4 ;
                                    SWAP ;
                                    CAR ;
                                    TRANSFER_TOKENS ;
                                    CONS } } } } ;
                    PAIR } } ;
         PAIR ;
         DUP ;
         CAR ;
         NIL operation ;
         SWAP ;
         CONS ;
         DIG 2 ;
         CAR ;
         DIG 2 ;
         CDR ;
         SOME ;
         SWAP ;
         PAIR ;
         CAR ;
         NONE address ;
         SWAP ;
         PAIR ;
         SWAP ;
         PAIR } }
