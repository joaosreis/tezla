{ storage
    (pair (pair (big_map %accessLogs string (map string (set (pair address timestamp))))
                (big_map %accessRights string (map string (set (pair address string)))))
          (big_map %agreements
             address
             (map string
                  (pair (pair (pair (set %data string) (address %employer)) (timestamp %leftDate))
                        (bool %updateRights))))) ;
  parameter
    (or (or (or (or (or (string %employeeResign)
                        (pair %insertAgreement
                           (pair (set %agreementHashSet string) (string %agreementId))
                           (address %employeeAddr)))
                    (pair %modifyAccessRights
                       (pair (pair (bool %addRights) (string %agreementHash)) (string %agreementId))
                       (address %userAddr)))
                (pair %modifyAgreement
                   (pair (pair (bool %addParams) (string %agreementHash)) (string %agreementId))
                   (address %employeeAddr)))
            (pair %modifyUpdateRights (string %agreementId) (bool %updateRights)))
        (pair %verfiyAccessRights
           (pair (string %agreementHash) (string %agreementId))
           (address %employeeAddr))) ;
  code { DUP ;
         CDR ;
         SWAP ;
         CAR ;
         IF_LEFT
           { IF_LEFT
               { IF_LEFT
                   { IF_LEFT
                       { IF_LEFT
                           { { SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               SENDER ;
                               MEM ;
                               IF { {} }
                                  { { PUSH string "WrongCondition: self.data.agreements.contains(sp.sender)" ;
                                      FAILWITH } } ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               SENDER ;
                               GET ;
                               IF_NONE { { PUSH string "Get-item:-1" ; FAILWITH } } {} ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               MEM ;
                               IF { {} }
                                  { { PUSH string
                                           "WrongCondition: self.data.agreements[sp.sender].contains(params.agreementId)" ;
                                      FAILWITH } } ;
                               PUSH timestamp "0" ;
                               DIG 2 ;
                               DUP ;
                               DUG 3 ;
                               CDR ;
                               SENDER ;
                               GET ;
                               IF_NONE { { PUSH string "Get-item:-1" ; FAILWITH } } {} ;
                               DIG 2 ;
                               DUP ;
                               DUG 3 ;
                               GET ;
                               IF_NONE { { PUSH string "Get-item:114" ; FAILWITH } } {} ;
                               CAR ;
                               CDR ;
                               COMPARE ;
                               EQ ;
                               IF { {} }
                                  { { PUSH string
                                           "WrongCondition: self.data.agreements[sp.sender][params.agreementId].leftDate == sp.timestamp(0)" ;
                                      FAILWITH } } ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               DUP ;
                               CAR ;
                               SWAP ;
                               CDR ;
                               DUP ;
                               SENDER ;
                               DUP ;
                               DUG 2 ;
                               GET ;
                               IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                               DUP ;
                               DIG 5 ;
                               DUP ;
                               DUG 6 ;
                               DUP ;
                               DUG 2 ;
                               GET ;
                               IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                               DUP ;
                               CDR ;
                               SWAP ;
                               CAR ;
                               CAR ;
                               NOW ;
                               SWAP ;
                               PAIR ;
                               PAIR ;
                               SOME ;
                               SWAP ;
                               UPDATE ;
                               SOME ;
                               SWAP ;
                               UPDATE ;
                               SWAP ;
                               PAIR ;
                               DUG 2 ;
                               SWAP ;
                               DROP ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               DUP ;
                               CAR ;
                               SWAP ;
                               CDR ;
                               DUP ;
                               SENDER ;
                               DUP ;
                               DUG 2 ;
                               GET ;
                               IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                               DUP ;
                               DIG 5 ;
                               DUP ;
                               DUG 6 ;
                               DUP ;
                               DUG 2 ;
                               GET ;
                               IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                               CAR ;
                               PUSH bool False ;
                               SWAP ;
                               PAIR ;
                               SOME ;
                               SWAP ;
                               UPDATE ;
                               SOME ;
                               SWAP ;
                               UPDATE ;
                               SWAP ;
                               PAIR ;
                               DUG 2 ;
                               DROP ;
                               DROP } }
                           { { SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               CDR ;
                               MEM ;
                               IF { { SWAP ;
                                      DUP ;
                                      DUG 2 ;
                                      CDR ;
                                      SWAP ;
                                      DUP ;
                                      DUG 2 ;
                                      CDR ;
                                      GET ;
                                      IF_NONE { { PUSH string "Get-item:24" ; FAILWITH } } {} ;
                                      SWAP ;
                                      DUP ;
                                      DUG 2 ;
                                      CAR ;
                                      CDR ;
                                      MEM ;
                                      IF { { PUSH string
                                                  "WrongCondition: ~ (self.data.agreements[params.employeeAddr].contains(params.agreementId))" ;
                                             FAILWITH } }
                                         { {} } } }
                                  { {} } ;
                               SWAP ;
                               DUP ;
                               DUG 2 ;
                               DUP ;
                               CAR ;
                               SWAP ;
                               CDR ;
                               PUSH (map string
                                         (pair (pair (pair (set %data string) (address %employer)) (timestamp %leftDate))
                                               (bool %updateRights)))
                                    {} ;
                               PUSH bool False ;
                               PUSH timestamp "0" ;
                               SENDER ;
                               DIG 6 ;
                               DUP ;
                               DUG 7 ;
                               CAR ;
                               CAR ;
                               PAIR ;
                               PAIR ;
                               PAIR ;
                               SOME ;
                               DIG 4 ;
                               DUP ;
                               DUG 5 ;
                               CAR ;
                               CDR ;
                               UPDATE ;
                               SOME ;
                               DIG 3 ;
                               DUP ;
                               DUG 4 ;
                               CDR ;
                               UPDATE ;
                               SWAP ;
                               PAIR ;
                               DUG 2 ;
                               SWAP ;
                               DROP ;
                               PUSH (map string (set (pair address string))) {} ;
                               PUSH (map string (set (pair address timestamp))) {} ;
                               DIG 2 ;
                               DUP ;
                               DUG 3 ;
                               CAR ;
                               CAR ;
                               ITER { DIG 2 ;
                                      DUP ;
                                      DUG 3 ;
                                      PUSH (set (pair address string)) {} ;
                                      PUSH bool True ;
                                      PUSH string "employee" ;
                                      DIG 7 ;
                                      DUP ;
                                      DUG 8 ;
                                      CDR ;
                                      PAIR ;
                                      UPDATE ;
                                      PUSH bool True ;
                                      PUSH string "employer" ;
                                      SENDER ;
                                      PAIR ;
                                      UPDATE ;
                                      SOME ;
                                      DIG 2 ;
                                      DUP ;
                                      DUG 3 ;
                                      UPDATE ;
                                      DUG 3 ;
                                      DIG 2 ;
                                      DROP ;
                                      SWAP ;
                                      DUP ;
                                      DUG 2 ;
                                      PUSH (set (pair address timestamp)) {} ;
                                      PUSH bool True ;
                                      NOW ;
                                      DIG 7 ;
                                      DUP ;
                                      DUG 8 ;
                                      CDR ;
                                      PAIR ;
                                      UPDATE ;
                                      PUSH bool True ;
                                      NOW ;
                                      SENDER ;
                                      PAIR ;
                                      UPDATE ;
                                      SOME ;
                                      DIG 2 ;
                                      DUP ;
                                      DUG 3 ;
                                      UPDATE ;
                                      DUG 2 ;
                                      DROP ;
                                      DROP } ;
                               DIG 3 ;
                               DUP ;
                               DUG 4 ;
                               DUP ;
                               CDR ;
                               SWAP ;
                               CAR ;
                               DUP ;
                               CAR ;
                               SWAP ;
                               CDR ;
                               DIG 4 ;
                               DUP ;
                               DUG 5 ;
                               SOME ;
                               DIG 6 ;
                               DUP ;
                               DUG 7 ;
                               CAR ;
                               CDR ;
                               UPDATE ;
                               SWAP ;
                               PAIR ;
                               PAIR ;
                               DUG 4 ;
                               DIG 3 ;
                               DROP ;
                               DIG 3 ;
                               DUP ;
                               DUG 4 ;
                               DUP ;
                               CDR ;
                               SWAP ;
                               CAR ;
                               DUP ;
                               CDR ;
                               SWAP ;
                               CAR ;
                               DIG 3 ;
                               DUP ;
                               DUG 4 ;
                               SOME ;
                               DIG 6 ;
                               DUP ;
                               DUG 7 ;
                               CAR ;
                               CDR ;
                               UPDATE ;
                               PAIR ;
                               PAIR ;
                               DUG 4 ;
                               DROP ;
                               DROP ;
                               DROP ;
                               DROP } } }
                       { { SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           MEM ;
                           IF { {} }
                              { { PUSH string "WrongCondition: self.data.accessRights.contains(params.agreementId)" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:80" ; FAILWITH } } {} ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CAR ;
                           CDR ;
                           MEM ;
                           IF { {} }
                              { { PUSH string
                                       "WrongCondition: self.data.accessRights[params.agreementId].contains(params.agreementHash)" ;
                                  FAILWITH } } ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CDR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:80" ; FAILWITH } } {} ;
                           SWAP ;
                           DUP ;
                           DUG 2 ;
                           CAR ;
                           CAR ;
                           CDR ;
                           GET ;
                           IF_NONE { { PUSH string "Get-item:81" ; FAILWITH } } {} ;
                           PUSH string "employee" ;
                           SENDER ;
                           PAIR ;
                           MEM ;
                           IF { {} }
                              { { PUSH string
                                       "WrongCondition: self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employee'))" ;
                                  FAILWITH } } ;
                           DUP ;
                           CAR ;
                           CAR ;
                           CAR ;
                           IF { { SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:80" ; FAILWITH } } {} ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CAR ;
                                  CDR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:81" ; FAILWITH } } {} ;
                                  PUSH string "guest" ;
                                  DIG 2 ;
                                  DUP ;
                                  DUG 3 ;
                                  CDR ;
                                  PAIR ;
                                  MEM ;
                                  IF { { PUSH string
                                              "WrongCondition: ~ (self.data.accessRights[params.agreementId][params.agreementHash].contains((params.userAddr, 'guest')))" ;
                                         FAILWITH } }
                                     { {} } ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  DUP ;
                                  CDR ;
                                  SWAP ;
                                  CAR ;
                                  DUP ;
                                  CAR ;
                                  SWAP ;
                                  CDR ;
                                  DUP ;
                                  DIG 4 ;
                                  DUP ;
                                  DUG 5 ;
                                  CAR ;
                                  CDR ;
                                  DUP ;
                                  DUG 2 ;
                                  GET ;
                                  IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                                  DUP ;
                                  DIG 6 ;
                                  DUP ;
                                  DUG 7 ;
                                  CAR ;
                                  CAR ;
                                  CDR ;
                                  DUP ;
                                  DUG 2 ;
                                  GET ;
                                  IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
                                  PUSH bool True ;
                                  PUSH string "guest" ;
                                  DIG 9 ;
                                  DUP ;
                                  DUG 10 ;
                                  CDR ;
                                  PAIR ;
                                  UPDATE ;
                                  SOME ;
                                  SWAP ;
                                  UPDATE ;
                                  SOME ;
                                  SWAP ;
                                  UPDATE ;
                                  SWAP ;
                                  PAIR ;
                                  PAIR ;
                                  DUG 2 ;
                                  SWAP ;
                                  DROP } }
                              { { SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CDR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:80" ; FAILWITH } } {} ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  CAR ;
                                  CAR ;
                                  CDR ;
                                  GET ;
                                  IF_NONE { { PUSH string "Get-item:81" ; FAILWITH } } {} ;
                                  PUSH string "guest" ;
                                  DIG 2 ;
                                  DUP ;
                                  DUG 3 ;
                                  CDR ;
                                  PAIR ;
                                  MEM ;
                                  IF { {} }
                                     { { PUSH string
                                              "WrongCondition: self.data.accessRights[params.agreementId][params.agreementHash].contains((params.userAddr, 'guest'))" ;
                                         FAILWITH } } ;
                                  SWAP ;
                                  DUP ;
                                  DUG 2 ;
                                  DUP ;
                                  CDR ;
                                  SWAP ;
                                  CAR ;
                                  DUP ;
                                  CAR ;
                                  SWAP ;
                                  CDR ;
                                  DUP ;
                                  DIG 4 ;
                                  DUP ;
                                  DUG 5 ;
                                  CAR ;
                                  CDR ;
                                  DUP ;
                                  DUG 2 ;
                                  GET ;
                                  IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                                  DUP ;
                                  DIG 6 ;
                                  DUP ;
                                  DUG 7 ;
                                  CAR ;
                                  CAR ;
                                  CDR ;
                                  DUP ;
                                  DUG 2 ;
                                  GET ;
                                  IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
                                  PUSH bool False ;
                                  PUSH string "guest" ;
                                  DIG 9 ;
                                  DUP ;
                                  DUG 10 ;
                                  CDR ;
                                  PAIR ;
                                  UPDATE ;
                                  SOME ;
                                  SWAP ;
                                  UPDATE ;
                                  SOME ;
                                  SWAP ;
                                  UPDATE ;
                                  SWAP ;
                                  PAIR ;
                                  PAIR ;
                                  DUG 2 ;
                                  SWAP ;
                                  DROP } } ;
                           DROP } } }
                   { { SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string "WrongCondition: self.data.agreements.contains(params.employeeAddr)" ;
                              FAILWITH } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:51" ; FAILWITH } } {} ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       CAR ;
                       CDR ;
                       MEM ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr].contains(params.agreementId)" ;
                              FAILWITH } } ;
                       SENDER ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:51" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:52" ; FAILWITH } } {} ;
                       CAR ;
                       CAR ;
                       CDR ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].employer == sp.sender" ;
                              FAILWITH } } ;
                       PUSH bool True ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:51" ; FAILWITH } } {} ;
                       DIG 2 ;
                       DUP ;
                       DUG 3 ;
                       CAR ;
                       CDR ;
                       GET ;
                       IF_NONE { { PUSH string "Get-item:52" ; FAILWITH } } {} ;
                       CDR ;
                       COMPARE ;
                       EQ ;
                       IF { {} }
                          { { PUSH string
                                   "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].updateRights == True" ;
                              FAILWITH } } ;
                       DUP ;
                       CAR ;
                       CAR ;
                       CAR ;
                       IF { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:51" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:52" ; FAILWITH } } {} ;
                              CAR ;
                              CAR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              MEM ;
                              IF { { PUSH string
                                          "WrongCondition: ~ (self.data.agreements[params.employeeAddr][params.agreementId].data.contains(params.agreementHash))" ;
                                     FAILWITH } }
                                 { {} } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 3 ;
                              DUP ;
                              DUG 4 ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 5 ;
                              DUP ;
                              DUG 6 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              PUSH bool True ;
                              DIG 10 ;
                              DUP ;
                              DUG 11 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              PAIR ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              PUSH (set (pair address string)) {} ;
                              PUSH bool True ;
                              PUSH string "employee" ;
                              DIG 8 ;
                              DUP ;
                              DUG 9 ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              PUSH string "employer" ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              PUSH (set (pair address timestamp)) {} ;
                              PUSH bool True ;
                              NOW ;
                              DIG 8 ;
                              DUP ;
                              DUG 9 ;
                              CDR ;
                              PAIR ;
                              UPDATE ;
                              PUSH bool True ;
                              NOW ;
                              SENDER ;
                              PAIR ;
                              UPDATE ;
                              SOME ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } }
                          { { SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:51" ; FAILWITH } } {} ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CDR ;
                              GET ;
                              IF_NONE { { PUSH string "Get-item:52" ; FAILWITH } } {} ;
                              CAR ;
                              CAR ;
                              CAR ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              MEM ;
                              IF { {} }
                                 { { PUSH string
                                          "WrongCondition: self.data.agreements[params.employeeAddr][params.agreementId].data.contains(params.agreementHash)" ;
                                     FAILWITH } } ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 3 ;
                              DUP ;
                              DUG 4 ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              DIG 5 ;
                              DUP ;
                              DUG 6 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              PUSH bool False ;
                              DIG 10 ;
                              DUP ;
                              DUG 11 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              PAIR ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CAR ;
                              SWAP ;
                              CDR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              NONE (set (pair address string)) ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              SWAP ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP ;
                              SWAP ;
                              DUP ;
                              DUG 2 ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              CDR ;
                              SWAP ;
                              CAR ;
                              DUP ;
                              DIG 4 ;
                              DUP ;
                              DUG 5 ;
                              CAR ;
                              CDR ;
                              DUP ;
                              DUG 2 ;
                              GET ;
                              IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                              NONE (set (pair address timestamp)) ;
                              DIG 6 ;
                              DUP ;
                              DUG 7 ;
                              CAR ;
                              CAR ;
                              CDR ;
                              UPDATE ;
                              SOME ;
                              SWAP ;
                              UPDATE ;
                              PAIR ;
                              PAIR ;
                              DUG 2 ;
                              SWAP ;
                              DROP } } ;
                       SWAP ;
                       DUP ;
                       DUG 2 ;
                       DUP ;
                       CAR ;
                       SWAP ;
                       CDR ;
                       DUP ;
                       DIG 3 ;
                       DUP ;
                       DUG 4 ;
                       CDR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       DUP ;
                       DIG 5 ;
                       DUP ;
                       DUG 6 ;
                       CAR ;
                       CDR ;
                       DUP ;
                       DUG 2 ;
                       GET ;
                       IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                       CAR ;
                       PUSH bool False ;
                       SWAP ;
                       PAIR ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SOME ;
                       SWAP ;
                       UPDATE ;
                       SWAP ;
                       PAIR ;
                       DUG 2 ;
                       DROP ;
                       DROP } } }
               { { SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   SENDER ;
                   MEM ;
                   IF { {} }
                      { { PUSH string "WrongCondition: self.data.agreements.contains(sp.sender)" ;
                          FAILWITH } } ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   SENDER ;
                   GET ;
                   IF_NONE { { PUSH string "Get-item:-1" ; FAILWITH } } {} ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CAR ;
                   MEM ;
                   IF { {} }
                      { { PUSH string
                               "WrongCondition: self.data.agreements[sp.sender].contains(params.agreementId)" ;
                          FAILWITH } } ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   DUP ;
                   CAR ;
                   SWAP ;
                   CDR ;
                   DUP ;
                   SENDER ;
                   DUP ;
                   DUG 2 ;
                   GET ;
                   IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                   DUP ;
                   DIG 5 ;
                   DUP ;
                   DUG 6 ;
                   CAR ;
                   DUP ;
                   DUG 2 ;
                   GET ;
                   IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
                   CAR ;
                   DIG 6 ;
                   DUP ;
                   DUG 7 ;
                   CDR ;
                   SWAP ;
                   PAIR ;
                   SOME ;
                   SWAP ;
                   UPDATE ;
                   SOME ;
                   SWAP ;
                   UPDATE ;
                   SWAP ;
                   PAIR ;
                   DUG 2 ;
                   DROP ;
                   DROP } } }
           { { SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               MEM ;
               IF { {} }
                  { { PUSH string "WrongCondition: self.data.accessRights.contains(params.agreementId)" ;
                      FAILWITH } } ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               GET ;
               IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CAR ;
               MEM ;
               IF { {} }
                  { { PUSH string
                           "WrongCondition: self.data.accessRights[params.agreementId].contains(params.agreementHash)" ;
                      FAILWITH } } ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               GET ;
               IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CAR ;
               GET ;
               IF_NONE { { PUSH string "Get-item:97" ; FAILWITH } } {} ;
               PUSH string "guest" ;
               SENDER ;
               PAIR ;
               MEM ;
               IF { PUSH bool True }
                  { { SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CDR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CDR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CAR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:97" ; FAILWITH } } {} ;
                      PUSH string "employer" ;
                      SENDER ;
                      PAIR ;
                      MEM } } ;
               IF { PUSH bool True }
                  { { SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CDR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CDR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CAR ;
                      CAR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:97" ; FAILWITH } } {} ;
                      PUSH string "employee" ;
                      SENDER ;
                      PAIR ;
                      MEM } } ;
               IF { {} }
                  { { PUSH string
                           "WrongCondition: ((self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'guest'))) | (self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employer')))) | (self.data.accessRights[params.agreementId][params.agreementHash].contains((sp.sender, 'employee')))" ;
                      FAILWITH } } ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CDR ;
               GET ;
               IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CAR ;
               CAR ;
               GET ;
               IF_NONE { { PUSH string "Get-item:97" ; FAILWITH } } {} ;
               PUSH string "employer" ;
               SENDER ;
               PAIR ;
               MEM ;
               IF { { SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      SWAP ;
                      DUP ;
                      DUG 2 ;
                      CDR ;
                      MEM ;
                      IF { {} }
                         { { PUSH string "WrongCondition: self.data.agreements.contains(params.employeeAddr)" ;
                             FAILWITH } } ;
                      PUSH timestamp "0" ;
                      DIG 2 ;
                      DUP ;
                      DUG 3 ;
                      CDR ;
                      DIG 2 ;
                      DUP ;
                      DUG 3 ;
                      CDR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:104" ; FAILWITH } } {} ;
                      DIG 2 ;
                      DUP ;
                      DUG 3 ;
                      CAR ;
                      CDR ;
                      GET ;
                      IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
                      CAR ;
                      CDR ;
                      COMPARE ;
                      NEQ ;
                      IF { { PUSH int 157680000 ;
                             DIG 2 ;
                             DUP ;
                             DUG 3 ;
                             CDR ;
                             DIG 2 ;
                             DUP ;
                             DUG 3 ;
                             CDR ;
                             GET ;
                             IF_NONE { { PUSH string "Get-item:104" ; FAILWITH } } {} ;
                             DIG 2 ;
                             DUP ;
                             DUG 3 ;
                             CAR ;
                             CDR ;
                             GET ;
                             IF_NONE { { PUSH string "Get-item:96" ; FAILWITH } } {} ;
                             CAR ;
                             CDR ;
                             NOW ;
                             SUB ;
                             COMPARE ;
                             LT ;
                             IF { {} }
                                { { PUSH string
                                         "WrongCondition: (sp.now - self.data.agreements[params.employeeAddr][params.agreementId].leftDate) < 157680000" ;
                                    FAILWITH } } } }
                         { {} } } }
                  { {} } ;
               SWAP ;
               DUP ;
               DUG 2 ;
               DUP ;
               CDR ;
               SWAP ;
               CAR ;
               DUP ;
               CDR ;
               SWAP ;
               CAR ;
               DUP ;
               DIG 4 ;
               DUP ;
               DUG 5 ;
               CAR ;
               CDR ;
               DUP ;
               DUG 2 ;
               GET ;
               IF_NONE { { PUSH string "set_in_top-any" ; FAILWITH } } {} ;
               DUP ;
               DIG 6 ;
               DUP ;
               DUG 7 ;
               CAR ;
               CAR ;
               DUP ;
               DUG 2 ;
               GET ;
               IF_NONE { { PUSH string "set_in_top-nil-some" ; FAILWITH } } {} ;
               PUSH bool True ;
               NOW ;
               SENDER ;
               PAIR ;
               UPDATE ;
               SOME ;
               SWAP ;
               UPDATE ;
               SOME ;
               SWAP ;
               UPDATE ;
               PAIR ;
               PAIR ;
               DUG 2 ;
               DROP ;
               DROP } } ;
         NIL operation ;
         PAIR } }
